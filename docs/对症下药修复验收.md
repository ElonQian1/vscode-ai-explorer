# ğŸ¯ å¯¹ç—‡ä¸‹è¯ä¿®å¤ - éªŒæ”¶æ¸…å•

## ğŸ“‹ ä¿®å¤å®Œæˆ

### âœ… â‘  HTML æŒ‚è½½ç‚¹ä¿®å¤
- **#breadcrumb**: é¢åŒ…å±‘å¯¼èˆªå®¹å™¨
- **#card-layer**: æµ®åŠ¨å¡ç‰‡æŒ‚è½½å±‚ï¼ˆæ–°å¢ï¼‰
- **å¡ç‰‡å±‚æ ·å¼**: å®Œæ•´çš„å¯æ‹–æ‹½å¡ç‰‡CSS

### âœ… â‘¡ graphView.js æ¶ˆæ¯å¤„ç†ä¿®å¤
- **boot()**: è‡ªåŠ¨åˆ›å»ºç¼ºå¤±çš„å®¹å™¨
- **å®‰å…¨ updateBreadcrumb**: é˜²æ­¢ null é”™è¯¯
- **å¼ºåˆ¶èµ°å¡ç‰‡æµ**: ç»Ÿä¸€è°ƒç”¨ cardManager API
- **ACK æ¶ˆæ¯**: æ­£ç¡®çš„ç¡®è®¤æ¶ˆæ¯æ ¼å¼

### âœ… â‘¢ analysisCard.js é‡æ„
- **å­˜å‚¨æ¨¡å‹**: Map<path, {dom, data}> æ”¯æŒå¤šå¡ç‰‡
- **æ‹–æ‹½åŠŸèƒ½**: å®Œæ•´çš„ makeDraggable å®ç°
- **æ•°æ®åˆå¹¶**: AI ç»“æœæ­£ç¡®åˆå¹¶åˆ°ç°æœ‰å¡ç‰‡
- **API ç»Ÿä¸€**: mount/showCard/updateCard æ ‡å‡†ç­¾å

## ğŸ§ª éªŒæ”¶æµ‹è¯•

è¯·æŒ‰ä»¥ä¸‹æ­¥éª¤éªŒè¯ä¿®å¤æ•ˆæœï¼š

### 1. **æ§åˆ¶å°æ£€æŸ¥**
æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œåº”è¯¥çœ‹åˆ°ï¼š
```
[graphView] âœ… cardManager å·²æŒ‚è½½åˆ° card-layer
[analysisCard] âœ… cardManager å·²å°±ç»ªï¼ˆUMD/IIFEï¼‰- æ”¯æŒå¯æ‹–æ‹½å¡ç‰‡
```

**ä¸åº”è¯¥å†çœ‹åˆ°ï¼š**
- âŒ `Cannot set properties of null (setting 'innerHTML') at updateBreadcrumb`
- âŒ `cardManager æœªåˆå§‹åŒ–`
- âŒ `{hasAI: false}` é”™è¯¯çŠ¶æ€

### 2. **åŒå‡»æ–‡ä»¶æµ‹è¯•**
1. æ‰“å¼€æ–‡ä»¶æ ‘è“å›¾é¢æ¿
2. åŒå‡»ä»»æ„ TypeScript/JavaScript æ–‡ä»¶
3. **é¢„æœŸç»“æœ**ï¼š
   - âœ… åœ¨ç”»å¸ƒä¸Šæ–¹å‡ºç°**å¯æ‹–æ‹½å¡ç‰‡**ï¼ˆä¸æ˜¯åº•éƒ¨å¼¹çª—ï¼‰
   - âœ… å¡ç‰‡æ ‡é¢˜æ˜¾ç¤ºæ–‡ä»¶åï¼Œå¸¦æ‹–æ‹½å›¾æ ‡
   - âœ… ç«‹å³æ˜¾ç¤ºé™æ€åˆ†æç»“æœ
   - âœ… 10-15ç§’å AI åˆ†æç»“æœ**æ— é—ªçƒ**å¢é‡æ›´æ–°

### 3. **æ‹–æ‹½åŠŸèƒ½æµ‹è¯•**
1. ç‚¹å‡»å¡ç‰‡æ ‡é¢˜æ 
2. æ‹–æ‹½åˆ°ä¸åŒä½ç½®
3. **é¢„æœŸç»“æœ**ï¼š
   - âœ… å¡ç‰‡å¯ä»¥å¹³æ»‘æ‹–æ‹½ç§»åŠ¨
   - âœ… æ¾å¼€é¼ æ ‡åä¿æŒæ–°ä½ç½®
   - âœ… æ‹–æ‹½æ—¶é¼ æ ‡å˜ä¸º `grabbing`

### 4. **å¤šå¡ç‰‡æµ‹è¯•**
1. åŒå‡»ç¬¬ä¸€ä¸ªæ–‡ä»¶ï¼Œç­‰å¾…å¡ç‰‡å‡ºç°
2. åŒå‡»ç¬¬äºŒä¸ªæ–‡ä»¶
3. **é¢„æœŸç»“æœ**ï¼š
   - âœ… å‡ºç°ç¬¬äºŒå¼ å¡ç‰‡
   - âœ… ä¸¤å¼ å¡ç‰‡ä½ç½®ç•¥æœ‰åç§»ï¼Œäº’ä¸é®æŒ¡
   - âœ… ä¸¤å¼ å¡ç‰‡å¯ä»¥ç‹¬ç«‹æ‹–æ‹½

### 5. **AI åˆ†ææ•°æ®æµ‹è¯•**
æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ï¼Œåº”è¯¥çœ‹åˆ°ï¼š
```
[graphView] ğŸ“¨ æ”¶åˆ° show-analysis-card: /src/file.ts {hasStatic: true, loading: true}
[analysisCard] âœ… åˆ›å»ºæ–°å¡ç‰‡: /src/file.ts
[graphView] ğŸ“¨ æ”¶åˆ° update-analysis-card: /src/file.ts {hasInferences: true, hasRecommendations: true}
[analysisCard] âœ… AIåˆ†æç»“æœå·²æ›´æ–°: /src/file.ts
```

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### æ•°æ®æµä¿®å¤
1. **FileCapsule æ ¼å¼æ­£ç¡®è§£æ**ï¼š
   - `summary: {zh, en}` â†’ ä¸­æ–‡ä¼˜å…ˆæ˜¾ç¤º
   - `inferences[]` â†’ æ·±åº¦åˆ†æåˆ—è¡¨
   - `recommendations[]` â†’ æ”¹è¿›å»ºè®®åˆ—è¡¨

2. **æ¶ˆæ¯ç»“æ„ç»Ÿä¸€**ï¼š
   ```typescript
   // show-analysis-card
   payload: { path, static, loading: true }
   
   // update-analysis-card  
   payload: { path, inferences, recommendations, loading: false }
   ```

3. **API ç­¾åæ ‡å‡†åŒ–**ï¼š
   ```javascript
   cardManager.mount('#card-layer')
   cardManager.showCard(filePath, payload)
   cardManager.updateCard(filePath, payload)
   ```

### UI æ”¹è¿›
- **å¯æ‹–æ‹½**: ç‚¹å‡»æ ‡é¢˜æ æ‹–æ‹½ï¼Œæ”¯æŒå¤šå¡ç‰‡
- **è‡ªåŠ¨å®šä½**: æ–°å¡ç‰‡è‡ªåŠ¨é”™å¼€ä½ç½®
- **è§†è§‰åé¦ˆ**: æ‹–æ‹½æŒ‡ç¤ºã€æ‚¬åœæ•ˆæœ
- **å“åº”å¼**: æ”¯æŒ resize è°ƒæ•´å¤§å°

## ğŸ“Š ä¿®å¤å¯¹æ¯”

| é—®é¢˜ | ä¿®å¤å‰ | ä¿®å¤å |
|------|--------|--------|
| å¡ç‰‡æ˜¾ç¤º | åº•éƒ¨å¼¹çª— | å¯æ‹–æ‹½æµ®åŠ¨å¡ç‰‡ |
| AIæ•°æ® | `{hasAI: false}` | æ­£ç¡®æ˜¾ç¤ºæ¨æ–­å’Œå»ºè®® |
| å®¹å™¨é”™è¯¯ | `null.innerHTML` å¼‚å¸¸ | å®‰å…¨å®¹å™¨æ£€æŸ¥ |
| å¤šå¡ç‰‡ | ä¸æ”¯æŒ | æ”¯æŒå¤šå¡ç‰‡å¹¶å­˜ |
| ç”¨æˆ·ä½“éªŒ | å›ºå®šä½ç½® | è‡ªç”±æ‹–æ‹½å®šä½ |

---

## ğŸ‰ éªŒæ”¶ç»“æœ

- [ ] æ§åˆ¶å°æ— é”™è¯¯æ—¥å¿—
- [ ] åŒå‡»æ˜¾ç¤ºå¯æ‹–æ‹½å¡ç‰‡
- [ ] AI åˆ†æç»“æœæ­£ç¡®æ˜¾ç¤º
- [ ] å¤šå¡ç‰‡æ”¯æŒæ­£å¸¸
- [ ] æ‹–æ‹½åŠŸèƒ½æµç•…

**å¦‚æœä»¥ä¸Šå…¨éƒ¨ âœ…ï¼Œåˆ™ä¿®å¤æˆåŠŸï¼ç°åœ¨æ‚¨æœ‰äº†ä¸ç›®å½•æ ‘ç¿»è¯‘æ¨¡å—ä¸€è‡´çš„å¯æ‹–æ‹½æ™ºèƒ½å¡ç‰‡ç•Œé¢ã€‚**