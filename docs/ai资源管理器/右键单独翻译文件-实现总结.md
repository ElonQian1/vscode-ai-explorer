# å³é”®å•ç‹¬ç¿»è¯‘æ–‡ä»¶ - åŠŸèƒ½å®ç°æ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. Package.json é…ç½®

```json
âœ… æ·»åŠ å‘½ä»¤å®šä¹‰
   - aiExplorer.translateThisFile

âœ… é…ç½®è§†å›¾èœå•
   - AI Explorer è§†å›¾å³é”®èœå•ï¼ˆä»…å¯¹æ–‡ä»¶æ˜¾ç¤ºï¼‰
   - åŸç”Ÿèµ„æºç®¡ç†å™¨å³é”®èœå•
```

### 2. AIExplorerProvider å¢å¼º

```typescript
âœ… æ·»åŠ  translateUseCase å±æ€§
âœ… å®ç° translateThisFile() æ–¹æ³•
âœ… å®ç° resolveToFileUri() å‚æ•°è§£æ
âœ… æ”¯æŒå¤šç§å‚æ•°æ¥æº
   - AI Explorer èŠ‚ç‚¹
   - vscode.Uri
   - æ´»åŠ¨ç¼–è¾‘å™¨
   - å­—ç¬¦ä¸²è·¯å¾„
```

### 3. ExplorerAliasModule æ³¨å†Œ

```typescript
âœ… æ³¨å†Œ translateThisFile å‘½ä»¤
âœ… ä¼ å…¥ translateUseCase åˆ° Provider
âœ… å‘½ä»¤æ—¥å¿—è®°å½•
```

### 4. æ–‡æ¡£å®Œå–„

```markdown
âœ… æ¶æ„è®¾è®¡è¯´æ˜æ–‡æ¡£
âœ… ä½¿ç”¨æŒ‡å—æ–‡æ¡£
âœ… ä¸‰å±‚æ¶æ„å›¾
âœ… æ•°æ®æµç¨‹å›¾
âœ… æµ‹è¯•åœºæ™¯è¯´æ˜
```

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### åŠŸèƒ½ç‰¹æ€§

| ç‰¹æ€§ | å®ç°çŠ¶æ€ | è¯´æ˜ |
|------|---------|------|
| **AI Explorer å³é”®** | âœ… | åœ¨è§†å›¾ä¸­å³é”®æ–‡ä»¶ç¿»è¯‘ |
| **åŸç”Ÿèµ„æºç®¡ç†å™¨å³é”®** | âœ… | åœ¨ VS Code èµ„æºç®¡ç†å™¨å³é”®ç¿»è¯‘ |
| **å‘½ä»¤é¢æ¿è°ƒç”¨** | âœ… | ç¿»è¯‘å½“å‰ç¼–è¾‘å™¨æ–‡ä»¶ |
| **å‚æ•°è‡ªåŠ¨è§£æ** | âœ… | æ™ºèƒ½è¯†åˆ«ä¸åŒæ¥æºçš„å‚æ•° |
| **ç¿»è¯‘æ¥æºæç¤º** | âœ… | æ˜¾ç¤ºè¯å…¸/ç¼“å­˜/AI/è§„åˆ™ç­‰æ¥æº |
| **è¿›åº¦æç¤º** | âœ… | æ˜¾ç¤ºç¿»è¯‘è¿›åº¦ |
| **é”™è¯¯å¤„ç†** | âœ… | å‹å¥½çš„é”™è¯¯æç¤º |
| **ç¼“å­˜ä¼˜å…ˆ** | âœ… | ä¼˜å…ˆä½¿ç”¨ç¼“å­˜é¿å…é‡å¤è°ƒç”¨ |

### ç¿»è¯‘é“¾è·¯

```
1. æ£€æŸ¥ç¼“å­˜ (enhanced-translation:filename)
   â†“ æœªå‘½ä¸­
2. æŸ¥è¯¢è¯å…¸ (DictionaryManager)
   â†“ æœªå‘½ä¸­
3. åº”ç”¨è§„åˆ™ (Rule matching)
   â†“ æœªå‘½ä¸­
4. è°ƒç”¨ AI (MultiProviderAIClient)
   â†“ æˆåŠŸ
5. ä¿å­˜ç¼“å­˜
   â†“
6. æ›´æ–°è§†å›¾
```

## ğŸ“Š ä»£ç æ¶æ„

### æ–‡ä»¶ç»“æ„

```
src/
â”œâ”€â”€ features/
â”‚   â””â”€â”€ explorer-alias/
â”‚       â”œâ”€â”€ ExplorerAliasModule.ts          â† å‘½ä»¤æ³¨å†Œ
â”‚       â”œâ”€â”€ ui/
â”‚       â”‚   â””â”€â”€ AIExplorerProvider.ts       â† ç¿»è¯‘é€»è¾‘
â”‚       â””â”€â”€ app/
â”‚           â””â”€â”€ usecases/
â”‚               â””â”€â”€ EnhancedTranslateBatchUseCase.ts  â† ç¿»è¯‘æœåŠ¡
â”‚
â”œâ”€â”€ package.json                             â† èœå•é…ç½®
â”‚
â””â”€â”€ docs/
    â”œâ”€â”€ å³é”®å•ç‹¬ç¿»è¯‘æ–‡ä»¶-æ¶æ„è¯´æ˜.md         â† æ¶æ„æ–‡æ¡£
    â””â”€â”€ å³é”®å•ç‹¬ç¿»è¯‘æ–‡ä»¶-ä½¿ç”¨æŒ‡å—.md         â† ä½¿ç”¨æ–‡æ¡£
```

### å…³é”®ä»£ç æ®µ

#### 1. å‘½ä»¤æ³¨å†Œï¼ˆExplorerAliasModule.tsï¼‰

```typescript
this.registerCommand(context, 'aiExplorer.translateThisFile', async (item) => {
    this.logger.info('æ‰§è¡Œå•æ–‡ä»¶ç¿»è¯‘å‘½ä»¤');
    await this.treeProvider?.translateThisFile(item);
});
```

#### 2. ç¿»è¯‘æ–¹æ³•ï¼ˆAIExplorerProvider.tsï¼‰

```typescript
async translateThisFile(input?: any): Promise<void> {
    // 1. è§£æå‚æ•°
    const uri = await this.resolveToFileUri(input);
    
    // 2. éªŒè¯æ–‡ä»¶
    const stat = await vscode.workspace.fs.stat(uri);
    
    // 3. æ‰§è¡Œç¿»è¯‘
    const result = await this.translateUseCase!.translateSingle(fileName, {
        forceRefresh: false,
        enableLearning: true
    });
    
    // 4. æ›´æ–°è§†å›¾
    this.updateAlias(node, result.translated);
    
    // 5. æ˜¾ç¤ºç»“æœ
    vscode.window.showInformationMessage(`âœ… å·²ç¿»è¯‘ï¼š${fileName} â†’ ${result.translated}`);
}
```

#### 3. å‚æ•°è§£æï¼ˆAIExplorerProvider.tsï¼‰

```typescript
private async resolveToFileUri(input?: any): Promise<vscode.Uri | undefined> {
    if (!input) return vscode.window.activeTextEditor?.document?.uri;
    if (input instanceof vscode.Uri) return input;
    if (typeof input === "string") return vscode.Uri.file(input);
    if (input.resourceUri instanceof vscode.Uri) return input.resourceUri;
    // ... æ›´å¤šæ ¼å¼æ”¯æŒ
}
```

## ğŸ”§ æŠ€æœ¯äº®ç‚¹

### 1. æ™ºèƒ½å‚æ•°è§£æ

æ”¯æŒ 7 ç§ä¸åŒçš„å‚æ•°æ ¼å¼ï¼š
- `vscode.Uri` å¯¹è±¡
- å­—ç¬¦ä¸²è·¯å¾„
- `{ resourceUri: Uri }` å¯¹è±¡
- `{ uri: Uri }` å¯¹è±¡  
- `{ node: { path: string } }` å¯¹è±¡
- `{ path: string }` å¯¹è±¡
- `undefined`ï¼ˆä½¿ç”¨æ´»åŠ¨ç¼–è¾‘å™¨ï¼‰

### 2. ä¼˜é›…çš„é”™è¯¯å¤„ç†

```typescript
try {
    // ç¿»è¯‘é€»è¾‘
} catch (error) {
    this.logger.error('å•æ–‡ä»¶ç¿»è¯‘å¤±è´¥', error);
    vscode.window.showErrorMessage(
        `ç¿»è¯‘å¤±è´¥: ${error instanceof Error ? error.message : 'æœªçŸ¥é”™è¯¯'}`
    );
}
```

### 3. è¿›åº¦åé¦ˆ

```typescript
await vscode.window.withProgress({
    location: vscode.ProgressLocation.Notification,
    title: `æ­£åœ¨ç¿»è¯‘: ${fileName}`,
    cancellable: false
}, async (progress) => {
    progress.report({ increment: 0 });
    // æ‰§è¡Œç¿»è¯‘...
    progress.report({ increment: 70 });
    // æ›´æ–°è§†å›¾...
    progress.report({ increment: 100 });
});
```

### 4. ç¿»è¯‘æ¥æºè¿½è¸ª

```typescript
const sourceMap: Record<string, string> = {
    'dictionary': 'è¯å…¸',
    'rule': 'è§„åˆ™',
    'ai': 'AI',
    'cache': 'ç¼“å­˜',
    'fallback': 'å›é€€'
};

vscode.window.showInformationMessage(
    `âœ… å·²ç¿»è¯‘ï¼š${fileName} â†’ ${result.translated}ï¼ˆæ¥æºï¼š${sourceName}ï¼‰`
);
```

## ğŸ§ª æµ‹è¯•å»ºè®®

### æµ‹è¯•åœºæ™¯ 1: AI Explorer å³é”®

```
1. æ‰“å¼€ AI Explorer è§†å›¾
2. å±•å¼€ç›®å½•
3. å³é”®ç‚¹å‡» index.ts
4. é€‰æ‹© "ç¿»è¯‘æ­¤æ–‡ä»¶"
5. éªŒè¯ï¼š
   âœ“ ä»…è¯¥æ–‡ä»¶è¢«ç¿»è¯‘
   âœ“ åˆ«åæ˜¾ç¤ºåœ¨æ ‘è§†å›¾
   âœ“ å¼¹çª—æ˜¾ç¤ºç¿»è¯‘ç»“æœå’Œæ¥æº
```

### æµ‹è¯•åœºæ™¯ 2: åŸç”Ÿèµ„æºç®¡ç†å™¨å³é”®

```
1. åœ¨ VS Code èµ„æºç®¡ç†å™¨ä¸­
2. å³é”®ç‚¹å‡» package.json
3. é€‰æ‹© "AI èµ„æºç®¡ç†å™¨ï¼šç¿»è¯‘æ­¤æ–‡ä»¶"
4. éªŒè¯ï¼š
   âœ“ ç¿»è¯‘æˆåŠŸ
   âœ“ AI Explorer è§†å›¾åŒæ­¥æ›´æ–°
```

### æµ‹è¯•åœºæ™¯ 3: å‘½ä»¤é¢æ¿

```
1. æ‰“å¼€ config.ts æ–‡ä»¶
2. Ctrl+Shift+P
3. è¾“å…¥ "ç¿»è¯‘æ­¤æ–‡ä»¶"
4. éªŒè¯ï¼š
   âœ“ å½“å‰ç¼–è¾‘å™¨æ–‡ä»¶è¢«ç¿»è¯‘
```

### æµ‹è¯•åœºæ™¯ 4: ç¼“å­˜æµ‹è¯•

```
1. ç¿»è¯‘ä¸€ä¸ªæ–°æ–‡ä»¶ â†’ æ¥æºåº”è¯¥æ˜¯ "AI"
2. å†æ¬¡ç¿»è¯‘åŒä¸€æ–‡ä»¶ â†’ æ¥æºåº”è¯¥æ˜¯ "ç¼“å­˜"
3. æ¸…é™¤ç¼“å­˜
4. å†æ¬¡ç¿»è¯‘ â†’ æ¥æºåº”è¯¥æ˜¯ "AI"
```

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

| æ“ä½œ | é¢„æœŸè€—æ—¶ | ä¾èµ–å› ç´  |
|------|---------|---------|
| ç¼“å­˜å‘½ä¸­ | < 10ms | æœ¬åœ°ç¼“å­˜è¯»å– |
| è¯å…¸æŸ¥è¯¢ | < 5ms | å†…å­˜æŸ¥æ‰¾ |
| è§„åˆ™åŒ¹é… | < 10ms | æ­£åˆ™è¡¨è¾¾å¼ |
| AI ç¿»è¯‘ | 500-2000ms | ç½‘ç»œ+AI å¤„ç† |
| è§†å›¾æ›´æ–° | < 50ms | VS Code æ¸²æŸ“ |

## ğŸ¯ åç»­ä¼˜åŒ–æ–¹å‘

### çŸ­æœŸä¼˜åŒ–ï¼ˆ1-2å‘¨ï¼‰

- [ ] æ·»åŠ å¿«æ·é”®æ”¯æŒï¼ˆå¦‚ `Ctrl+Alt+T`ï¼‰
- [ ] å³é”®èœå•å›¾æ ‡ä¼˜åŒ–
- [ ] ç¿»è¯‘å†å²è®°å½•
- [ ] æ’¤é”€ç¿»è¯‘åŠŸèƒ½

### ä¸­æœŸä¼˜åŒ–ï¼ˆ1-2æœˆï¼‰

- [ ] æ‰¹é‡é€‰æ‹©æ–‡ä»¶ç¿»è¯‘
- [ ] ç¿»è¯‘è´¨é‡è¯„åˆ†
- [ ] è‡ªå®šä¹‰ç¿»è¯‘è§„åˆ™
- [ ] å¤šè¯­è¨€æ”¯æŒï¼ˆä¸ä»…é™ä¸­æ–‡ï¼‰

### é•¿æœŸä¼˜åŒ–ï¼ˆ3-6æœˆï¼‰

- [ ] AI ä¸Šä¸‹æ–‡æ„ŸçŸ¥ç¿»è¯‘
- [ ] æ™ºèƒ½æ¨èç¿»è¯‘
- [ ] ç¿»è¯‘ç»Ÿè®¡åˆ†æ
- [ ] äº‘ç«¯åŒæ­¥ç¿»è¯‘ç¼“å­˜

## ğŸ“š ç›¸å…³æ–‡æ¡£é“¾æ¥

- **æ¶æ„è®¾è®¡**: [å³é”®å•ç‹¬ç¿»è¯‘æ–‡ä»¶-æ¶æ„è¯´æ˜.md](./å³é”®å•ç‹¬ç¿»è¯‘æ–‡ä»¶-æ¶æ„è¯´æ˜.md)
- **ä½¿ç”¨æŒ‡å—**: [å³é”®å•ç‹¬ç¿»è¯‘æ–‡ä»¶-ä½¿ç”¨æŒ‡å—.md](./å³é”®å•ç‹¬ç¿»è¯‘æ–‡ä»¶-ä½¿ç”¨æŒ‡å—.md)
- **ç¿»è¯‘æ¨¡å—**: [ç¬¬3æ­¥.md](./ç¬¬3æ­¥.md)
- **åŸå§‹éœ€æ±‚**: [å•ç‹¬ç¿»è¯‘ä¸€ä¸ªæ–‡ä»¶.md](./å•ç‹¬ç¿»è¯‘ä¸€ä¸ªæ–‡ä»¶.md)

## ğŸš€ å¦‚ä½•ä½¿ç”¨

### ç«‹å³ä½“éªŒ

1. **é‡å¯æ‰©å±•å¼€å‘ä¸»æœº**
   ```
   æŒ‰ F5 æˆ–ç‚¹å‡» "è¿è¡Œå’Œè°ƒè¯•"
   ```

2. **æµ‹è¯• AI Explorer å³é”®**
   - æ‰“å¼€ AI Explorer è§†å›¾
   - å³é”®ä»»æ„æ–‡ä»¶
   - é€‰æ‹© "ç¿»è¯‘æ­¤æ–‡ä»¶ï¼ˆä»…æ­¤æ–‡ä»¶ï¼‰"

3. **æµ‹è¯•åŸç”Ÿèµ„æºç®¡ç†å™¨å³é”®**
   - åœ¨å·¦ä¾§èµ„æºç®¡ç†å™¨
   - å³é”®ä»»æ„æ–‡ä»¶
   - é€‰æ‹© "AI èµ„æºç®¡ç†å™¨ï¼šç¿»è¯‘æ­¤æ–‡ä»¶"

4. **éªŒè¯åŠŸèƒ½**
   - æŸ¥çœ‹ç¿»è¯‘ç»“æœå¼¹çª—
   - æ³¨æ„"æ¥æº"ä¿¡æ¯
   - æ£€æŸ¥ AI Explorer è§†å›¾æ›´æ–°

### æ•…éšœæ’æŸ¥

å¦‚æœå³é”®èœå•æ²¡å‡ºç°ï¼š
1. ç¡®ä¿é€‰ä¸­çš„æ˜¯æ–‡ä»¶ï¼ˆä¸æ˜¯æ–‡ä»¶å¤¹ï¼‰
2. é‡å¯æ‰©å±•å¼€å‘ä¸»æœºï¼ˆF5ï¼‰
3. æ£€æŸ¥è¾“å‡ºé¢æ¿çš„æ—¥å¿—

å¦‚æœç¿»è¯‘å¤±è´¥ï¼š
1. è¿è¡Œ "æ£€æŸ¥AIçŠ¶æ€" å‘½ä»¤
2. éªŒè¯ API Key é…ç½®
3. æŸ¥çœ‹è¾“å‡ºé¢æ¿çš„é”™è¯¯æ—¥å¿—

## âœ¨ æ€»ç»“

é€šè¿‡è¿™æ¬¡å®ç°ï¼Œæˆ‘ä»¬æˆåŠŸæ·»åŠ äº†ï¼š

âœ… **ä¾¿æ·çš„å³é”®èœå•** - ä¸‰ç§ä½¿ç”¨æ–¹å¼
âœ… **æ™ºèƒ½å‚æ•°è§£æ** - å…¼å®¹å¤šç§æ¥æº
âœ… **å®Œå–„çš„é”™è¯¯å¤„ç†** - å‹å¥½çš„ç”¨æˆ·æç¤º
âœ… **ç¿»è¯‘æ¥æºè¿½è¸ª** - é€æ˜çš„ç¿»è¯‘æµç¨‹
âœ… **è¯¦ç»†çš„æ–‡æ¡£** - æ¶æ„+ä½¿ç”¨åŒæŒ‡å—

è¿™ä¸ªåŠŸèƒ½è®©ç”¨æˆ·å¯ä»¥å¿«é€Ÿç¿»è¯‘å•ä¸ªæ–‡ä»¶ï¼Œæ— éœ€æ‰¹é‡å¤„ç†æ•´ä¸ªç›®å½•ï¼Œå¤§å¤§æå‡äº†æ—¥å¸¸ä½¿ç”¨çš„ä¾¿åˆ©æ€§ï¼

---

**å®ç°æ—¥æœŸ**: 2025-10-14
**å¼€å‘è€…**: GitHub Copilot
**ç‰ˆæœ¬**: v0.1.0
