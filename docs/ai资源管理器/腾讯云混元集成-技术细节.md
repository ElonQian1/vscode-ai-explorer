# è…¾è®¯äº‘æ··å…ƒé›†æˆè¯´æ˜ - æŠ€æœ¯ç»†èŠ‚

## ğŸ“Œ å…³é”®æ¦‚å¿µæ¾„æ¸…

### âŒ å¸¸è§è¯¯è§£

**è¯¯è§£ 1**ï¼šä½¿ç”¨"å…ƒå® App"çš„ API
- âŒ å…ƒå®ï¼ˆYuanbaoï¼‰æ˜¯ C ç«¯åº”ç”¨ï¼Œä¸æä¾›å®˜æ–¹ API
- âœ… å®é™…ä½¿ç”¨ï¼šè…¾è®¯äº‘æ··å…ƒå¤§æ¨¡å‹çš„ OpenAI å…¼å®¹æ¥å£

**è¯¯è§£ 2**ï¼šéœ€è¦ä½¿ç”¨ SecretId + SecretKey
- âŒ ä¼ ç»Ÿè…¾è®¯äº‘ API çš„è®¤è¯æ–¹å¼ï¼ˆå¤æ‚çš„ç­¾åç®—æ³•ï¼‰
- âœ… OpenAI å…¼å®¹æ¥å£ä½¿ç”¨ä¸“ç”¨ API Keyï¼ˆç›´æ¥ä¼ é€’ï¼‰

**è¯¯è§£ 3**ï¼šéœ€è¦ç‰¹æ®Šçš„ SDK
- âŒ éœ€è¦å®‰è£…è…¾è®¯äº‘ä¸“ç”¨ SDK
- âœ… ç›´æ¥ä½¿ç”¨æ ‡å‡† OpenAI SDKï¼ˆ`openai` npm åŒ…ï¼‰

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### é›†æˆåŸç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      AI Explorer Extension              â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  MultiProviderAIClient            â”‚ â”‚
â”‚  â”‚                                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
â”‚  â”‚  â”‚  Provider A â”‚  â”‚  Provider B â”‚â”‚ â”‚
â”‚  â”‚  â”‚  (OpenAI)   â”‚  â”‚  (Hunyuan)  â”‚â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚
â”‚  â”‚         â”‚                 â”‚       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚            â”‚                 â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                 â”‚
             â†“                 â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  OpenAI Client   â”‚  â”‚  OpenAI Client       â”‚
  â”‚  (openai npm)    â”‚  â”‚  (same package)      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ baseURL:         â”‚  â”‚ baseURL:             â”‚
  â”‚ api.openai.com   â”‚  â”‚ api.hunyuan.cloud... â”‚
  â”‚                  â”‚  â”‚                      â”‚
  â”‚ apiKey:          â”‚  â”‚ apiKey:              â”‚
  â”‚ sk-xxxxxx        â”‚  â”‚ hunyuan-xxxxxx       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                 â”‚
             â†“                 â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  OpenAI API      â”‚  â”‚  Tencent Cloud       â”‚
  â”‚  (Official)      â”‚  â”‚  Hunyuan OpenAI      â”‚
  â”‚                  â”‚  â”‚  Compatible API      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä»£ç å®ç°

```typescript
// ç»Ÿä¸€ä½¿ç”¨ OpenAI SDK
import { OpenAI } from 'openai';

// OpenAI å®˜æ–¹
const openaiClient = new OpenAI({
  apiKey: 'sk-xxxxxxxx',
  baseURL: 'https://api.openai.com/v1'
});

// è…¾è®¯äº‘æ··å…ƒï¼ˆOpenAI å…¼å®¹ï¼‰
const hunyuanClient = new OpenAI({
  apiKey: 'hunyuan-xxxxxxxx',  // ä¸æ˜¯ SecretId/SecretKey
  baseURL: 'https://api.hunyuan.cloud.tencent.com/v1'
});

// è°ƒç”¨æ–¹å¼å®Œå…¨ç›¸åŒ
const response = await client.chat.completions.create({
  model: 'gpt-3.5-turbo',  // æˆ– 'hunyuan-turbo'
  messages: [{ role: 'user', content: 'Hello' }]
});
```

## ğŸ”„ OpenAI å…¼å®¹æ€§è¯¦è§£

### å…¼å®¹çš„ API ç«¯ç‚¹

æ ¹æ®[è…¾è®¯äº‘å®˜æ–¹æ–‡æ¡£](https://cloud.tencent.com/document/product/1729/111007)ï¼š

| API ç«¯ç‚¹ | OpenAI | è…¾è®¯æ··å…ƒ | è¯´æ˜ |
|---------|--------|----------|------|
| `/v1/chat/completions` | âœ… | âœ… | å¯¹è¯è¡¥å…¨ï¼ˆä¸»è¦ä½¿ç”¨ï¼‰ |
| `/v1/embeddings` | âœ… | âœ… | å‘é‡åµŒå…¥ |
| Function Calling | âœ… | âœ… | å‡½æ•°è°ƒç”¨ |
| Streaming | âœ… | âœ… | æµå¼å“åº” |
| `/v1/images/generations` | âœ… | âŒ | å›¾åƒç”Ÿæˆï¼ˆæ··å…ƒä¸æ”¯æŒï¼‰ |
| `/v1/audio/*` | âœ… | âŒ | éŸ³é¢‘å¤„ç†ï¼ˆæ··å…ƒä¸æ”¯æŒï¼‰ |

### å‚æ•°å…¼å®¹æ€§

```typescript
// å®Œå…¨å…¼å®¹çš„å‚æ•°
{
  model: string,           // âœ… æ¨¡å‹åç§°ï¼ˆä¸åŒæä¾›å•†ä½¿ç”¨å„è‡ªæ¨¡å‹ï¼‰
  messages: Array,         // âœ… æ¶ˆæ¯æ•°ç»„
  temperature: number,     // âœ… æ¸©åº¦å‚æ•° (0-2)
  max_tokens: number,      // âœ… æœ€å¤§ token æ•°
  stream: boolean,         // âœ… æ˜¯å¦æµå¼è¿”å›
  top_p: number,          // âœ… æ ¸é‡‡æ ·å‚æ•°
  frequency_penalty: number, // âš ï¸ éƒ¨åˆ†æ”¯æŒï¼ŒæŸ¥çœ‹æ–‡æ¡£
  presence_penalty: number,  // âš ï¸ éƒ¨åˆ†æ”¯æŒï¼ŒæŸ¥çœ‹æ–‡æ¡£
}
```

### å“åº”æ ¼å¼

```typescript
// ä¸¤è€…å“åº”æ ¼å¼å®Œå…¨ä¸€è‡´
{
  id: string,
  object: "chat.completion",
  created: number,
  model: string,
  choices: [{
    index: number,
    message: {
      role: "assistant",
      content: string
    },
    finish_reason: string
  }],
  usage: {
    prompt_tokens: number,
    completion_tokens: number,
    total_tokens: number
  }
}
```

## ğŸ” è®¤è¯æœºåˆ¶å¯¹æ¯”

### OpenAI å®˜æ–¹

```http
POST https://api.openai.com/v1/chat/completions
Authorization: Bearer sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Content-Type: application/json
```

### è…¾è®¯äº‘æ··å…ƒï¼ˆOpenAI å…¼å®¹ï¼‰

```http
POST https://api.hunyuan.cloud.tencent.com/v1/chat/completions
Authorization: Bearer hunyuan-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Content-Type: application/json
```

**å…³é”®å·®å¼‚**ï¼š
- OpenAI: API Key ä»¥ `sk-` å¼€å¤´
- è…¾è®¯æ··å…ƒ: API Key ä»¥ `hunyuan-` å¼€å¤´ï¼ˆæˆ–å…¶ä»–å‰ç¼€ï¼‰
- ä¸¤è€…éƒ½ä½¿ç”¨ `Authorization: Bearer` å¤´éƒ¨
- **ä¸éœ€è¦**ä¼ ç»Ÿè…¾è®¯äº‘ API çš„ç­¾åç®—æ³•

## ğŸš€ åˆ‡æ¢æä¾›å•†çš„ä¼˜åŠ¿

### 1. ä»£ç é›¶ä¿®æ”¹

```typescript
// é…ç½®é©±åŠ¨ï¼Œä»£ç æ— éœ€æ”¹åŠ¨
const client = new OpenAI({
  apiKey: config.get('apiKey'),      // ä»é…ç½®è¯»å–
  baseURL: config.get('baseURL')     // ä»é…ç½®è¯»å–
});

// è°ƒç”¨ä»£ç å®Œå…¨ç›¸åŒ
const result = await client.chat.completions.create({...});
```

### 2. è‡ªåŠ¨é™çº§

```typescript
async sendRequest(request: AIRequest): Promise<AIResponse> {
  try {
    // å°è¯•ä¸»æä¾›å•†ï¼ˆå¦‚ OpenAIï¼‰
    return await this.sendToProvider('openai', request);
  } catch (error) {
    // è‡ªåŠ¨é™çº§åˆ°å¤‡ç”¨æä¾›å•†ï¼ˆå¦‚æ··å…ƒï¼‰
    return await this.sendToProvider('hunyuan', request);
  }
}
```

### 3. æˆæœ¬ä¼˜åŒ–

```typescript
// æ ¹æ®ä»»åŠ¡ç±»å‹é€‰æ‹©æä¾›å•†
if (task.type === 'batch-translation') {
  // æ‰¹é‡ä»»åŠ¡ç”¨æ›´ä¾¿å®œçš„æ··å…ƒ
  provider = 'hunyuan';
  model = 'hunyuan-lite';
} else if (task.type === 'critical') {
  // å…³é”®ä»»åŠ¡ç”¨ OpenAI
  provider = 'openai';
  model = 'gpt-4';
}
```

## ğŸ“Š æ€§èƒ½ä¸æˆæœ¬æ¯”è¾ƒ

| ç»´åº¦ | OpenAI (GPT-3.5) | è…¾è®¯æ··å…ƒ (turbo) | è¯´æ˜ |
|------|------------------|------------------|------|
| **å»¶è¿Ÿ** | 200-500ms | 150-400ms | å›½å†…è®¿é—®æ··å…ƒæ›´å¿« |
| **å¯ç”¨æ€§** | 99.9% | 99.5%+ | ä¸¤è€…éƒ½é«˜å¯ç”¨ |
| **æˆæœ¬** | $$ | $ | æ··å…ƒç›¸å¯¹ä¾¿å®œ |
| **è´¨é‡** | â­â­â­â­ | â­â­â­ | GPT-3.5 ç•¥ä¼˜ |
| **ä¸­æ–‡** | â­â­â­ | â­â­â­â­ | æ··å…ƒä¸­æ–‡æ›´å¥½ |

## âš ï¸ æ³¨æ„äº‹é¡¹ä¸é™åˆ¶

### 1. æ¨¡å‹åç§°ä¸é€šç”¨

```typescript
// âŒ ä¸èƒ½ç›´æ¥æ›¿æ¢
openai: 'gpt-3.5-turbo'  â†’  hunyuan: 'gpt-3.5-turbo'  // é”™è¯¯ï¼

// âœ… éœ€è¦ä½¿ç”¨å¯¹åº”æ¨¡å‹
openai: 'gpt-3.5-turbo'  â†’  hunyuan: 'hunyuan-turbo'  // æ­£ç¡®
```

### 2. éƒ¨åˆ†é«˜çº§åŠŸèƒ½å·®å¼‚

```typescript
// OpenAI ç‹¬æœ‰
- DALL-E å›¾åƒç”Ÿæˆ
- Whisper è¯­éŸ³è¯†åˆ«
- GPT-4V è§†è§‰ç†è§£

// è…¾è®¯æ··å…ƒç‹¬æœ‰
- æ›´å¥½çš„ä¸­æ–‡è¯­ä¹‰ç†è§£
- å›½å†…åˆè§„æ€§ä¿è¯
- æ›´ä½çš„è®¿é—®å»¶è¿Ÿï¼ˆå›½å†…ï¼‰
```

### 3. é€Ÿç‡é™åˆ¶ä¸åŒ

```typescript
// OpenAI (å…è´¹å±‚)
- 3 RPM (requests per minute)
- 40,000 TPM (tokens per minute)

// è…¾è®¯æ··å…ƒ (æŒ‰é‡è®¡è´¹)
- æ ¹æ®è´¦å·ç­‰çº§åŠ¨æ€è°ƒæ•´
- é€šå¸¸æ¯” OpenAI æ›´å®½æ¾
```

## ğŸ¯ æœ€ä½³å®è·µ

### 1. é…ç½®ç®¡ç†

```json
// .vscode/settings.json (é¡¹ç›®çº§)
{
  "aiExplorer.provider.primary": "hunyuan",
  "aiExplorer.hunyuanModel": "hunyuan-turbo"
}

// User Settings (å…¨å±€)
{
  "aiExplorer.hunyuanApiKey": "hunyuan-xxxxxxxx",
  "aiExplorer.openaiApiKey": "sk-xxxxxxxx"
}
```

### 2. é”™è¯¯å¤„ç†

```typescript
try {
  result = await aiClient.sendRequest(request);
} catch (error) {
  if (error.message.includes('model_not_found')) {
    // æ¨¡å‹ä¸å­˜åœ¨ï¼Œæ£€æŸ¥æ¨¡å‹åç§°é…ç½®
  } else if (error.message.includes('Invalid API key')) {
    // API Key æ— æ•ˆï¼Œæ£€æŸ¥å¯†é’¥æ ¼å¼
  } else if (error.message.includes('Rate limit')) {
    // é€Ÿç‡é™åˆ¶ï¼Œå®æ–½é€€é¿ç­–ç•¥
  }
}
```

### 3. æ—¥å¿—ç›‘æ§

```typescript
logger.debug(`[${provider}] è¯·æ±‚: model=${model}, tokens=${tokens}`);
logger.info(`[${provider}] å“åº”: cost=${cost}, latency=${latency}ms`);
logger.warn(`[${provider}] é™çº§: ${primaryProvider} â†’ ${fallbackProvider}`);
```

## ğŸ“š å‚è€ƒé“¾æ¥

- [è…¾è®¯äº‘æ··å…ƒ OpenAI å…¼å®¹æ¥å£æ–‡æ¡£](https://cloud.tencent.com/document/product/1729/111007)
- [OpenAI API å‚è€ƒ](https://platform.openai.com/docs/api-reference)
- [OpenAI Node.js SDK](https://github.com/openai/openai-node)

## ğŸ’¡ æ€»ç»“

**æ ¸å¿ƒè¦ç‚¹**ï¼š
1. âœ… ä½¿ç”¨è…¾è®¯äº‘æ··å…ƒçš„**å®˜æ–¹ OpenAI å…¼å®¹æ¥å£**
2. âœ… ä½¿ç”¨æ ‡å‡† **OpenAI SDK**ï¼ˆ`openai` npm åŒ…ï¼‰
3. âœ… é€šè¿‡åˆ‡æ¢ `baseURL` å’Œ `apiKey` å®ç°æä¾›å•†åˆ‡æ¢
4. âŒ ä¸ä½¿ç”¨"å…ƒå® App"çš„éå®˜æ–¹æ¥å£
5. âŒ ä¸ä½¿ç”¨ä¼ ç»Ÿè…¾è®¯äº‘ API çš„ SecretId/SecretKey è®¤è¯

**æŠ€æœ¯ä¼˜åŠ¿**ï¼š
- ä»£ç é›¶ä¿®æ”¹
- è‡ªåŠ¨é™çº§
- æˆæœ¬ä¼˜åŒ–
- é«˜å¯ç”¨æ€§
