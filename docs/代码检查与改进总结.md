# ä»£ç æ£€æŸ¥ä¸æ”¹è¿›æ€»ç»“

## ğŸ“‹ éœ€æ±‚æ¥æº

æ ¹æ®ä¸‰ä¸ªæ–‡æ¡£çš„è¦æ±‚æ£€æŸ¥å’Œæ”¹è¿›ä»£ç ï¼š

1. **1ã€çº¯å¤§å†™æ€ä¹ˆåŠï¼Ÿ.md** - ç™½åå•æœºåˆ¶å’Œå°å†™è¯å…¸æŸ¥æ‰¾
2. **2ã€çº¯å¤§å†™aiå…œåº•.md** - AI å…œåº•ç»“æ„åŒ–å“åº”
3. **3ã€å¤§å†™ä¹Ÿåº”è¯¥ç›´æ¥é€šè¿‡å­—å…¸.md** - è¯å…¸ä¼˜å…ˆ + å¯¹é½æ£€æµ‹

## âœ… ç°æœ‰å®ç°æ£€æŸ¥ç»“æœ

### 1. è¯å…ƒåˆ†ç±»ï¼ˆSplitWithDelimiters.tsï¼‰

**âœ… å·²å®Œæˆ**ï¼š`classify()` å‡½æ•°æ­£ç¡®å®ç°äº†ç™½åå•æœºåˆ¶

```typescript
// å…¨å¤§å†™ï¼šä»…ç™½åå•æ‰å½“ acronymï¼Œå…¶å®ƒå½“æ™®é€šè¯
if (/^[A-Z]{2,}$/.test(raw)) {
  const allowlist = getAcronymAllowlist();
  if (allowlist.has(raw)) {
    return { raw, lower, type: 'acronym' };  // ç™½åå•ï¼šAPI/HTML/URL
  } else {
    return { raw, lower, type: 'word' };     // æ™®é€šè¯ï¼šDEBUG/WARNING
  }
}
```

**ç»“è®º**ï¼š
- âœ… éç™½åå•å¤§å†™è¯ï¼ˆDEBUG/WARNINGï¼‰è¢«æ ‡è®°ä¸º `type: 'word'`
- âœ… ç™½åå•è¯ï¼ˆAPI/HTTP/URLï¼‰è¢«æ ‡è®°ä¸º `type: 'acronym'`
- âœ… æ‰€æœ‰è¯å…ƒå­˜å‚¨å°å†™å½¢å¼åœ¨ `lower` å­—æ®µ

### 2. è¯å…¸æŸ¥æ‰¾ï¼ˆDictionaryResolver.tsï¼‰

**âœ… å·²å®Œæˆ**ï¼š`resolveWord()` å‡½æ•°ä½¿ç”¨å°å†™é”®æŸ¥æ‰¾

```typescript
resolveWord(word: string): DictEntry | null {
  const lower = word.toLowerCase();
  
  // ç›´æ¥æŸ¥æ‰¾
  if (this.wordMap.has(word)) { ... }
  if (this.wordMap.has(lower)) {  // â† ä½¿ç”¨å°å†™æŸ¥æ‰¾
    return this.wordMap.get(lower)!;
  }
  ...
}
```

**âœ… å·²å®Œæˆ**ï¼š`writeProjectLearning()` ä½¿ç”¨å°å†™é”®å†™å…¥

```typescript
const key = word.toLowerCase();  // â† å¼ºåˆ¶å°å†™é”®
if (key.includes(' ')) {
  dict.phrases[key] = { alias, confidence: 1.0 };
} else {
  dict.words[key] = { alias, confidence: 1.0 };
}
```

**ç»“è®º**ï¼š
- âœ… è¯å…¸æŸ¥æ‰¾è‡ªåŠ¨è½¬å°å†™
- âœ… è¯å…¸å†™å…¥æ°¸è¿œä½¿ç”¨å°å†™é”®
- âœ… DEBUG å’Œ debug æŸ¥æ‰¾ç»“æœä¸€è‡´

### 3. AI å…œåº•ï¼ˆLiteralAIFallback.tsï¼‰

**âŒ éœ€è¦æ”¹è¿›**ï¼šæ—§å®ç°ç¼ºå°‘ç»“æ„åŒ–å“åº”å’Œå¯¹é½æ£€æµ‹

## ğŸ”§ æ”¹è¿›å†…å®¹

### æ”¹è¿› 1ï¼šæ–°å¢ç»“æ„åŒ–ç±»å‹å®šä¹‰

```typescript
/**
 * AI ç¿»è¯‘ç»“æœé¡¹ï¼ˆç»“æ„åŒ–ï¼‰
 */
export type AITranslationItem = {
    /** è‹±æ–‡é”®ï¼ˆå°å†™ï¼‰ */
    key: string;
    /** ä¸­æ–‡ç¿»è¯‘ */
    alias: string;
    /** ç±»å‹ï¼šnormal=å•è¯, phrase=çŸ­è¯­ */
    kind: 'normal' | 'phrase';
    /** ç½®ä¿¡åº¦ (0-1) */
    confidence: number;
};
```

### æ”¹è¿› 2ï¼šæ–°å¢ç»“æ„åŒ–æ–¹æ³•

```typescript
async suggestLiteralTranslationsStructured(
    fileName: string,
    unknownWords: string[]
): Promise<AITranslationItem[]>
```

**ç‰¹æ€§**ï¼š

1. **æ˜ç¡®å¤§å°å†™è§„åˆ™çš„ AI æç¤ºè¯**ï¼š
   ```
   9. âš ï¸ çº¯å¤§å†™è¯ï¼ˆå¦‚DEBUG/WARNINGï¼‰ä¸æ˜¯ç¼©å†™ï¼Œæ˜¯æ™®é€šå•è¯ï¼Œåº”å½“ç¿»è¯‘
   10. âš ï¸ å¿…é¡»ä¸ºæ¯ä¸ªè¾“å…¥è¯è¿”å›ç¿»è¯‘ï¼Œä¸èƒ½é—æ¼
   ```

2. **å¯¹é½æ£€æµ‹ï¼ˆAlignment Guardï¼‰**ï¼š
   ```typescript
   const normalItems = items.filter(item => item.kind === 'normal');
   if (normalItems.length < unknownWords.length) {
       console.warn(`å¯¹é½è­¦å‘Šï¼šè¾“å…¥${unknownWords.length}ä¸ªè¯ï¼ŒAIè¿”å›${normalItems.length}ä¸ªå•è¯ç¿»è¯‘`);
   }
   ```

3. **ç¼ºå¤±è¯æ ‡è®°**ï¼š
   ```typescript
   const returnedKeys = new Set(normalItems.map(i => i.key.toLowerCase()));
   const missingWords = unknownWords.filter(w => !returnedKeys.has(w.toLowerCase()));
   if (missingWords.length > 0) {
       console.warn(`ç¼ºå¤±è¯: ${missingWords.join(', ')}`);
   }
   ```

4. **ç½®ä¿¡åº¦è¿‡æ»¤**ï¼š
   ```typescript
   const MIN_CONFIDENCE = 0.5;
   const filtered = items.filter(item => item.confidence >= MIN_CONFIDENCE);
   ```

### æ”¹è¿› 3ï¼šå…¼å®¹æ—§æ¥å£

```typescript
async suggestLiteralTranslations(
    fileName: string,
    unknownWords: string[]
): Promise<Record<string, string>> {
    const items = await this.suggestLiteralTranslationsStructured(fileName, unknownWords);
    
    // è½¬æ¢ä¸ºç®€å•æ˜ å°„ï¼ˆå…¼å®¹ç°æœ‰ä»£ç ï¼‰
    const mappings: Record<string, string> = {};
    for (const item of items) {
        mappings[item.key] = item.alias;
    }
    
    return mappings;
}
```

## ğŸ“Š æµ‹è¯•éªŒè¯

### æµ‹è¯•ç”¨ä¾‹ 1ï¼šçº¯å¤§å†™è¯ç¿»è¯‘

**è¾“å…¥**ï¼š`DEBUG_USEFORM_WARNING_ATTRIBUTION.md`

**é¢„æœŸæµç¨‹**ï¼š

```
1. åˆ†è¯ï¼š
   DEBUG â†’ { raw: "DEBUG", lower: "debug", type: "word" }
   USEFORM â†’ { raw: "USEFORM", lower: "useform", type: "word" }
   WARNING â†’ { raw: "WARNING", lower: "warning", type: "word" }
   ATTRIBUTION â†’ { raw: "ATTRIBUTION", lower: "attribution", type: "word" }

2. è¯å…¸æŸ¥æ‰¾ï¼ˆä½¿ç”¨ lower å°å†™é”®ï¼‰ï¼š
   debug â†’ âœ— æœªæ‰¾åˆ°
   useform â†’ âœ— æœªæ‰¾åˆ°
   warning â†’ âœ“ è­¦å‘Š (å‡è®¾åœ¨è¯å…¸ä¸­)
   attribution â†’ âœ— æœªæ‰¾åˆ°

3. AI å…œåº•ï¼š
   è¾“å…¥: ["DEBUG", "USEFORM", "ATTRIBUTION"]
   
   AI å“åº”:
   [
     { key: "debug", alias: "è°ƒè¯•", kind: "normal", confidence: 1.0 },
     { key: "useform", alias: "ä½¿ç”¨è¡¨å•", kind: "normal", confidence: 0.8 },
     { key: "attribution", alias: "å½’å› ", kind: "normal", confidence: 0.9 }
   ]
   
   å¯¹é½æ£€æµ‹: 3 ä¸ªè¾“å…¥ = 3 ä¸ªè¿”å› âœ…

4. å†™å…¥å­¦ä¹ è¯å…¸ï¼ˆå°å†™é”®ï¼‰ï¼š
   {
     "debug": { "alias": "è°ƒè¯•", "confidence": 1.0 },
     "useform": { "alias": "ä½¿ç”¨è¡¨å•", "confidence": 0.8 },
     "attribution": { "alias": "å½’å› ", "confidence": 0.9 }
   }

5. é‡æ–°ç¿»è¯‘ï¼š
   debug â†’ è°ƒè¯•
   useform â†’ ä½¿ç”¨è¡¨å•
   warning â†’ è­¦å‘Š
   attribution â†’ å½’å› 

6. é‡å»ºåˆ«åï¼ˆä¿ç•™åˆ†éš”ç¬¦ï¼‰ï¼š
   è°ƒè¯•_ä½¿ç”¨è¡¨å•_è­¦å‘Š_å½’å› .md
```

### æµ‹è¯•ç”¨ä¾‹ 2ï¼šå¯¹é½æ£€æµ‹ï¼ˆAI é—æ¼è¯ï¼‰

**è¾“å…¥**ï¼š`["DEBUG", "UNKNOWN", "WARNING"]`

**AI é”™è¯¯å“åº”**ï¼š
```json
[
  { "key": "debug", "alias": "è°ƒè¯•", "kind": "normal" },
  { "key": "warning", "alias": "è­¦å‘Š", "kind": "normal" }
]
```

**å¯¹é½æ£€æµ‹è¾“å‡º**ï¼š
```
âš ï¸ å¯¹é½è­¦å‘Šï¼šè¾“å…¥3ä¸ªè¯ï¼ŒAIè¿”å›2ä¸ªå•è¯ç¿»è¯‘
  è¾“å…¥è¯: DEBUG, UNKNOWN, WARNING
  AIè¿”å›: debug, warning
  ç¼ºå¤±è¯: UNKNOWN
```

## ğŸ“ æ”¹è¿›æ–‡ä»¶åˆ—è¡¨

| æ–‡ä»¶ | æ”¹è¿›å†…å®¹ | çŠ¶æ€ |
|------|----------|------|
| `src/features/explorer-alias/infra/translators/LiteralAIFallback.ts` | æ–°å¢ç»“æ„åŒ–å“åº” + å¯¹é½æ£€æµ‹ | âœ… å·²å®Œæˆ |
| `docs/ä¿®å¤-AIå…œåº•å¢å¼º.md` | è¯¦ç»†æ”¹è¿›æ–‡æ¡£ | âœ… å·²åˆ›å»º |
| `scripts/verify-ai-fallback-logic.js` | é€»è¾‘éªŒè¯è„šæœ¬ | âœ… å·²åˆ›å»º |

## ğŸ¯ æ»¡è¶³æ–‡æ¡£è¦æ±‚å¯¹ç…§è¡¨

| æ–‡æ¡£ | è¦æ±‚ | å®ç°çŠ¶æ€ |
|------|------|----------|
| **1ã€çº¯å¤§å†™æ€ä¹ˆåŠï¼Ÿ.md** | ç™½åå•æœºåˆ¶ | âœ… classify() å·²å®ç° |
| | éç™½åå•å¤§å†™è¯å½“æ™®é€šè¯ | âœ… type: 'word' |
| | å°å†™è¯å…¸é”® | âœ… resolveWord() è‡ªåŠ¨è½¬å°å†™ |
| **2ã€çº¯å¤§å†™aiå…œåº•.md** | ç»“æ„åŒ– JSON å“åº” | âœ… AITranslationItem |
| | key/alias/kind/confidence | âœ… æ–°å¢ç±»å‹å®šä¹‰ |
| | æ˜ç¡®å¤§å†™è¯å¤„ç† | âœ… AI æç¤ºè¯ç¬¬ 9 æ¡ |
| **3ã€å¤§å†™ä¹Ÿåº”è¯¥ç›´æ¥é€šè¿‡å­—å…¸.md** | è¯å…¸ä¼˜å…ˆæŸ¥æ‰¾ | âœ… LiteralAliasBuilderV2 |
| | å°å†™é”®å†™å…¥ | âœ… writeProjectLearning() |
| | å¯¹é½æ£€æµ‹ | âœ… Alignment Guard |
| | ç¼ºå¤±è¯æ ‡è®° | âœ… missingWords æ£€æµ‹ |

## ğŸš€ ä½¿ç”¨æŒ‡å—

### 1. é‡æ–°åŠ è½½ VS Code

```
Ctrl+Shift+P â†’ Developer: Reload Window
```

### 2. é…ç½®ç¼©å†™ç™½åå•ï¼ˆå¯é€‰ï¼‰

åœ¨ `.vscode/settings.json` ä¸­ï¼š

```json
{
  "aiExplorer.alias.acronymAllowlist": [
    "UI", "API", "HTTP", "HTTPS", "URL", "URI",
    "DOM", "ID", "UUID", "JSON", "XML", "HTML",
    "CSS", "SQL", "JWT", "OAuth", "CORS", "CSRF"
  ]
}
```

### 3. æµ‹è¯•çœŸå®æ–‡ä»¶

åˆ›å»ºæµ‹è¯•æ–‡ä»¶ï¼š`DEBUG_USEFORM_WARNING.md`

å³é”® â†’ `AI Explorer: Translate File/Folder`

### 4. æ£€æŸ¥å­¦ä¹ è¯å…¸

æ‰“å¼€ `.ai/.ai-glossary.literal.learned.json`ï¼ŒéªŒè¯é”®æ˜¯å°å†™ï¼š

```json
{
  "words": {
    "debug": { "alias": "è°ƒè¯•", "confidence": 1.0 },
    "useform": { "alias": "ä½¿ç”¨è¡¨å•", "confidence": 0.8 },
    "warning": { "alias": "è­¦å‘Š", "confidence": 1.0 }
  }
}
```

### 5. æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—

æ‰“å¼€ `å¸®åŠ©` â†’ `åˆ‡æ¢å¼€å‘äººå‘˜å·¥å…·` â†’ `Console`

æŸ¥æ‰¾ï¼š
- `[LiteralAIFallback] å¯¹é½è­¦å‘Š` - è¯æ•°ä¸åŒ¹é…è­¦å‘Š
- `[DictionaryResolver] å·²å†™å…¥å­¦ä¹ è¯å…¸` - å†™å…¥ç¡®è®¤

## ğŸ“ˆ ä¼˜åŠ¿æ€»ç»“

### âœ… å·¥ç¨‹è´¨é‡

- **å‘åå…¼å®¹**ï¼šæ—§æ¥å£ `suggestLiteralTranslations()` ç»§ç»­å·¥ä½œ
- **å¯æ‰©å±•**ï¼šæ–°æ¥å£æä¾›æ›´å¤šå…ƒæ•°æ®ï¼ˆkind/confidenceï¼‰
- **é˜²å¾¡æ€§ç¼–ç¨‹**ï¼šå¯¹é½æ£€æµ‹ + ç½®ä¿¡åº¦è¿‡æ»¤
- **è°ƒè¯•å‹å¥½**ï¼šè¯¦ç»†è­¦å‘Šæ—¥å¿—

### âœ… ç”¨æˆ·ä½“éªŒ

- **æ›´å‡†ç¡®**ï¼šAI æ˜ç¡®çŸ¥é“å¦‚ä½•å¤„ç†å¤§å†™è¯
- **æ›´å¯é **ï¼šå¯¹é½æ£€æµ‹é˜²æ­¢ AI é—æ¼ç¿»è¯‘
- **æ›´é€æ˜**ï¼šæ§åˆ¶å°æ—¥å¿—æ˜¾ç¤ºå®Œæ•´æµç¨‹

### âœ… ç»´æŠ¤æ€§

- **ç±»å‹å®‰å…¨**ï¼šTypeScript ç±»å‹å®šä¹‰
- **æ–‡æ¡£å®Œå–„**ï¼šä»£ç æ³¨é‡Š + Markdown æ–‡æ¡£
- **æµ‹è¯•è¦†ç›–**ï¼šé€»è¾‘éªŒè¯è„šæœ¬

## ğŸ” ä¸‹ä¸€æ­¥å»ºè®®

1. **å¢å¼º AI æç¤ºè¯**ï¼šæ ¹æ®å®é™…ä½¿ç”¨åé¦ˆè°ƒæ•´
2. **æ‰©å±•ç™½åå•**ï¼šæ ¹æ®ç”¨æˆ·é¡¹ç›®è¡¥å……å¸¸ç”¨ç¼©å†™
3. **æ€§èƒ½ä¼˜åŒ–**ï¼šæ‰¹é‡ç¿»è¯‘æ—¶åˆå¹¶ç›¸åŒæœªçŸ¥è¯
4. **é”™è¯¯æ¢å¤**ï¼šAI å¤±è´¥æ—¶çš„å¤‡ç”¨ç­–ç•¥

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [ä¿®å¤-çŸ­è¯­åŒ¹é…ä¸¢å¤±å†…éƒ¨åˆ†éš”ç¬¦.md](./ä¿®å¤-çŸ­è¯­åŒ¹é…ä¸¢å¤±å†…éƒ¨åˆ†éš”ç¬¦.md)
- [ä¿®å¤-æ–‡ä»¶å¤¹ç¿»è¯‘ç»Ÿä¸€.md](./ä¿®å¤-æ–‡ä»¶å¤¹ç¿»è¯‘ç»Ÿä¸€.md)
- [ä¿®å¤-æ–‡ä»¶å¤¹å³é”®èœå•.md](./ä¿®å¤-æ–‡ä»¶å¤¹å³é”®èœå•.md)
- [ä¿®å¤-AIå…œåº•å¢å¼º.md](./ä¿®å¤-AIå…œåº•å¢å¼º.md) â¬…ï¸ **æœ¬æ¬¡æ”¹è¿›**

## âœ… æ€»ç»“

å½“å‰ä»£ç **åŸºæœ¬æ»¡è¶³**æ–‡æ¡£è¦æ±‚ï¼Œåªéœ€è¦æ”¹è¿› AI å…œåº•éƒ¨åˆ†ï¼š

- âœ… è¯å…ƒåˆ†ç±»ï¼šç™½åå•æœºåˆ¶å·²æ­£ç¡®å®ç°
- âœ… è¯å…¸æŸ¥æ‰¾ï¼šå°å†™é”®å·²æ­£ç¡®ä½¿ç”¨
- âœ… AI å…œåº•ï¼š**å·²å‡çº§ä¸ºç»“æ„åŒ–å“åº” + å¯¹é½æ£€æµ‹**

**ç¼–è¯‘çŠ¶æ€**ï¼šâœ… é€šè¿‡ï¼ˆæ— é”™è¯¯ï¼‰

**ä¸‹ä¸€æ­¥**ï¼šç”¨æˆ·æµ‹è¯•çœŸå®æ–‡ä»¶å¹¶è§‚å¯Ÿæ§åˆ¶å°æ—¥å¿—
