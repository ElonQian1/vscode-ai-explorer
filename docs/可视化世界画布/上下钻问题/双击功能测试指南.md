# åŒå‡»ä¸‹é’»åŠŸèƒ½æµ‹è¯•æŒ‡å—

## ğŸ¯ æµ‹è¯•ç›®æ ‡

éªŒè¯æ–‡ä»¶å¤¹åŒå‡»ä¸‹é’»å’Œæ ¹èŠ‚ç‚¹åŒå‡»ä¸Šé’»åŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚

---

## ğŸ“‹ å‰ç½®å‡†å¤‡

### 1. ç¡®ä¿ä»£ç å·²ç¼–è¯‘

```powershell
npm run compile
```

### 2. é‡è½½ VS Code çª—å£

- æ–¹æ³• 1ï¼šæŒ‰ `Ctrl+R`
- æ–¹æ³• 2ï¼š`F1` â†’ `Developer: Reload Window`

### 3. æ‰“å¼€åŒæ§åˆ¶å°

**Webview æ§åˆ¶å°**ï¼ˆæŸ¥çœ‹å‰ç«¯æ—¥å¿—ï¼‰ï¼š
- `F1` â†’ è¾“å…¥ `Open Webview Developer Tools`
- é€‰æ‹©å¯¹åº”çš„ Webview
- åˆ‡æ¢åˆ° `Console` æ ‡ç­¾

**Extension Host æ§åˆ¶å°**ï¼ˆæŸ¥çœ‹åç«¯æ—¥å¿—ï¼‰ï¼š
- `F1` â†’ è¾“å…¥ `Toggle Developer Tools`
- åˆ‡æ¢åˆ° `Console` æ ‡ç­¾

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### æ­¥éª¤ 1ï¼šæ‰“å¼€è“å›¾

1. åœ¨èµ„æºç®¡ç†å™¨æ‰¾ä¸€ä¸ªæœ‰å­æ–‡ä»¶å¤¹çš„ç›®å½•
2. å³é”®ç‚¹å‡»æ–‡ä»¶å¤¹
3. é€‰æ‹© **"ä»è·¯å¾„ç”Ÿæˆè“å›¾"**
4. ç­‰å¾…è“å›¾é¢æ¿æ‰“å¼€

âœ… **é¢„æœŸ**ï¼šé¢æ¿æ˜¾ç¤ºæ–‡ä»¶æ ‘å›¾è¡¨

### æ­¥éª¤ 2ï¼šå¯ç”¨è¯Šæ–­æ¨¡å¼

1. ç¡®ä¿ Webview æ§åˆ¶å°å¤„äºæ¿€æ´»çŠ¶æ€
2. åœ¨è“å›¾é¢æ¿ä¸ŠæŒ‰ `Ctrl+Shift+D`
3. è§‚å¯Ÿæ§åˆ¶å°è¾“å‡º

âœ… **é¢„æœŸè¾“å‡º**ï¼š
```
ğŸ” äº‹ä»¶è¯Šæ–­: å¼€å¯
ğŸ“Š å½“å‰å›¾è¡¨çŠ¶æ€: {
    graphType: 'filetree',
    nodeCount: X,
    folderNodes: Y,
    rootNode: {...}
}
ğŸ“ æ–‡ä»¶å¤¹èŠ‚ç‚¹è¯¦æƒ…:
  - folder1: { hasPath: true, path: 'D:\\...', isRoot: false, ... }
  - folder2: { hasPath: true, path: 'D:\\...', isRoot: false, ... }
  - ...
ğŸ’¡ æç¤ºï¼šåŒå‡»æ–‡ä»¶å¤¹èŠ‚ç‚¹æŸ¥çœ‹äº‹ä»¶è·¯å¾„
```

### æ­¥éª¤ 3ï¼šæµ‹è¯•åŒå‡»ä¸‹é’»

1. **è¯†åˆ«å­æ–‡ä»¶å¤¹èŠ‚ç‚¹**ï¼ˆæœ‰ ğŸ“ å›¾æ ‡ä¸”ä¸æ˜¯æ ¹èŠ‚ç‚¹ï¼‰
2. **åŒå‡»å­æ–‡ä»¶å¤¹èŠ‚ç‚¹**ï¼ˆæ³¨æ„ï¼šä¸è¦ç§»åŠ¨é¼ æ ‡ï¼‰
3. **è§‚å¯Ÿ Webview æ§åˆ¶å°**
4. **è§‚å¯Ÿ Extension Host æ§åˆ¶å°**
5. **è§‚å¯Ÿé¢æ¿å˜åŒ–**

âœ… **é¢„æœŸè¡Œä¸º**ï¼š

**Webview æ§åˆ¶å°**ï¼š
```
ğŸ–±ï¸ åŒå‡»äº‹ä»¶è·¯å¾„: node node-folder > node-content > nodes > canvas > ...
ğŸ¯ ç›®æ ‡å…ƒç´ : <div class="node-content">...</div>
[åŒå‡»] å­æ–‡ä»¶å¤¹ï¼Œå‘é€ drill: D:\rust\active-projects\...\subfolder
```

**Extension Host æ§åˆ¶å°**ï¼š
```
[handleDrill] æ”¶åˆ°ä¸‹é’»è¯·æ±‚, payload: {path: 'D:\\rust\\active-projects\\...\\subfolder'}
[handleDrill] æå–çš„ folderPath: D:\rust\active-projects\...\subfolder
ä¸‹é’»åˆ°: D:\rust\active-projects\...\subfolder
å¼€å§‹æµ…å±‚æ‰«æ: D:\rust\active-projects\...\subfolder
æµ…å±‚æ‰«æå®Œæˆ: X ä¸ªæ–‡ä»¶å¤¹, Y ä¸ªæ–‡ä»¶
æ˜¾ç¤ºè“å›¾: ğŸ“ subfolder (Z ä¸ªèŠ‚ç‚¹)
å·²åˆ·æ–°åˆ°å­ç›®å½•: D:\rust\active-projects\...\subfolder
æ˜¾ç¤ºè“å›¾: ğŸ“ subfolder (Z ä¸ªèŠ‚ç‚¹)
```

**é¢æ¿å˜åŒ–**ï¼š
- âœ… æ ‡é¢˜å˜ä¸ºï¼š`è“å›¾: subfolder`
- âœ… èŠ‚ç‚¹åˆ·æ–°ä¸ºå­æ–‡ä»¶å¤¹çš„å†…å®¹
- âœ… æ ¹èŠ‚ç‚¹å˜ä¸ºåˆšæ‰åŒå‡»çš„æ–‡ä»¶å¤¹

### æ­¥éª¤ 4ï¼šæµ‹è¯•åŒå‡»ä¸Šé’»

1. **è¯†åˆ«æ ¹èŠ‚ç‚¹**ï¼ˆæ ‡é¢˜ä¸­çš„æ–‡ä»¶å¤¹åå¯¹åº”çš„èŠ‚ç‚¹ï¼‰
2. **åŒå‡»æ ¹èŠ‚ç‚¹**
3. **è§‚å¯Ÿæ§åˆ¶å°å’Œé¢æ¿**

âœ… **é¢„æœŸè¡Œä¸º**ï¼š

**Webview æ§åˆ¶å°**ï¼š
```
[åŒå‡»] æ ¹èŠ‚ç‚¹ï¼Œå‘é€ drill-up: D:\rust\active-projects\...\subfolder
```

**Extension Host æ§åˆ¶å°**ï¼š
```
[handleDrillUp] å¼€å§‹è¿”å›ä¸Šä¸€çº§
å½“å‰è·¯å¾„: D:\rust\active-projects\...\subfolder
çˆ¶è·¯å¾„: D:\rust\active-projects\...
è¿”å›ä¸Šä¸€çº§: D:\rust\active-projects\...
æ˜¾ç¤ºè“å›¾: ğŸ“ parent (X ä¸ªèŠ‚ç‚¹)
```

**é¢æ¿å˜åŒ–**ï¼š
- âœ… è¿”å›åˆ°çˆ¶æ–‡ä»¶å¤¹
- âœ… æ ‡é¢˜æ¢å¤ä¸ºçˆ¶æ–‡ä»¶å¤¹å
- âœ… èŠ‚ç‚¹æ¢å¤ä¸ºçˆ¶æ–‡ä»¶å¤¹å†…å®¹

### æ­¥éª¤ 5ï¼šæµ‹è¯•æ‹–æ‹½åŠŸèƒ½

1. **æŒ‰ä½èŠ‚ç‚¹å¹¶ç§»åŠ¨**ï¼ˆç§»åŠ¨è¶…è¿‡ 5 åƒç´ ï¼‰
2. **è§‚å¯Ÿæ§åˆ¶å°**

âœ… **é¢„æœŸè¡Œä¸º**ï¼š

**Webview æ§åˆ¶å°**ï¼š
```
[æ‹–æ‹½] å¼€å§‹æ‹–æ‹½èŠ‚ç‚¹: folder_name
[æ‹–æ‹½] ç»“æŸæ‹–æ‹½èŠ‚ç‚¹: folder_name
```

**èŠ‚ç‚¹è¡Œä¸º**ï¼š
- âœ… èŠ‚ç‚¹è·Ÿéšé¼ æ ‡ç§»åŠ¨
- âœ… è¾¹çº¿å®æ—¶æ›´æ–°
- âœ… é‡Šæ”¾åä½ç½®ä¿æŒ

### æ­¥éª¤ 6ï¼šæµ‹è¯•æ‹–æ‹½ä¸å¹²æ‰°åŒå‡»

1. **åŒå‡»èŠ‚ç‚¹ï¼Œä½†æ‰‹ç¨å¾®æŠ–åŠ¨ 1-2 åƒç´ **
2. **è§‚å¯Ÿæ˜¯å¦ä»èƒ½ä¸‹é’»**

âœ… **é¢„æœŸè¡Œä¸º**ï¼š
- âœ… ä»ç„¶è§¦å‘ä¸‹é’»ï¼ˆä¸ä¼šå˜æˆæ‹–æ‹½ï¼‰
- âœ… Webview æ§åˆ¶å°æœ‰ `[åŒå‡»]` æ—¥å¿—
- âœ… æ²¡æœ‰ `[æ‹–æ‹½]` æ—¥å¿—

---

## âŒ é—®é¢˜æ’æŸ¥

### é—®é¢˜ 1ï¼šåŒå‡»æ²¡æœ‰ä»»ä½•ååº”

**ç—‡çŠ¶**ï¼š
- Webview æ§åˆ¶å°æ²¡æœ‰ `[åŒå‡»]` æ—¥å¿—
- Extension æ§åˆ¶å°æ²¡æœ‰ä»»ä½•è¾“å‡º
- é¢æ¿ä¸åˆ·æ–°

**å¯èƒ½åŸå› **ï¼š

#### 1.1 æ£€æŸ¥ graphType

```javascript
// åœ¨ Webview æ§åˆ¶å°è¿è¡Œï¼š
console.log(graph?.metadata?.graphType);
```

âœ… **åº”è¯¥è¾“å‡º**ï¼š`'filetree'`  
âŒ **å¦‚æœä¸æ˜¯**ï¼šåŒå‡»äº‹ä»¶ä¸ä¼šç»‘å®š

#### 1.2 æ£€æŸ¥èŠ‚ç‚¹æ•°æ®

```javascript
// åœ¨ Webview æ§åˆ¶å°è¿è¡Œï¼š
graph?.nodes?.filter(n => n.type === 'folder').forEach(n => {
    console.log(n.label, 'â†’ path:', n.data?.path, '| isRoot:', n.data?.isRoot);
});
```

âœ… **åº”è¯¥è¾“å‡º**ï¼šæ¯ä¸ªæ–‡ä»¶å¤¹éƒ½æœ‰ `path` å±æ€§  
âŒ **å¦‚æœæ²¡æœ‰**ï¼šåŒå‡»ä¸ä¼šå‘é€æ¶ˆæ¯

#### 1.3 æ£€æŸ¥äº‹ä»¶æ˜¯å¦è¢«é®æŒ¡

```javascript
// åœ¨ Webview æ§åˆ¶å°è¿è¡Œï¼š
document.addEventListener('dblclick', (e) => {
    console.log('åŸç”ŸåŒå‡»äº‹ä»¶è§¦å‘:', e.target);
}, true);
```

ç„¶ååŒå‡»èŠ‚ç‚¹ï¼Œè§‚å¯Ÿæ˜¯å¦æœ‰æ—¥å¿—ã€‚

âœ… **æœ‰æ—¥å¿—**ï¼šäº‹ä»¶èƒ½åˆ°è¾¾ï¼Œæ£€æŸ¥ç»‘å®šé€»è¾‘  
âŒ **æ²¡æ—¥å¿—**ï¼šè¢« CSS å±‚é®æŒ¡

#### 1.4 æ£€æŸ¥ CSS

```javascript
// åœ¨ Webview æ§åˆ¶å°è¿è¡Œï¼š
const svg = document.querySelector('svg.edges');
const help = document.querySelector('.help-overlay');
console.log('SVG pointer-events:', getComputedStyle(svg).pointerEvents);
console.log('Help pointer-events:', getComputedStyle(help).pointerEvents);
```

âœ… **åº”è¯¥è¾“å‡º**ï¼š`'none'`, `'none'`  
âŒ **å¦‚æœæ˜¯ 'auto'**ï¼šè¿™äº›å±‚åœ¨æ‹¦æˆªäº‹ä»¶

---

### é—®é¢˜ 2ï¼šå‰ç«¯æœ‰æ—¥å¿—ï¼Œåç«¯æ²¡ååº”

**ç—‡çŠ¶**ï¼š
- Webview æ§åˆ¶å°æœ‰ `[åŒå‡»]` æ—¥å¿—
- Extension æ§åˆ¶å°æ²¡æœ‰ `[handleDrill]` æ—¥å¿—

**å¯èƒ½åŸå› **ï¼š

#### 2.1 æ¶ˆæ¯æœªåˆ°è¾¾åç«¯

æ£€æŸ¥ `BlueprintPanel.ts` çš„ `onDidReceiveMessage` æ˜¯å¦æ­£ç¡®ç»‘å®šã€‚

#### 2.2 æ¶ˆæ¯ç±»å‹ä¸åŒ¹é…

æ£€æŸ¥å‘é€çš„æ¶ˆæ¯ç±»å‹æ˜¯å¦ä¸º `'drill'` æˆ– `'drill-up'`ã€‚

---

### é—®é¢˜ 3ï¼šåç«¯æœ‰æ—¥å¿—ï¼Œä½†ä¸åˆ·æ–°

**ç—‡çŠ¶**ï¼š
- Extension æ§åˆ¶å°æœ‰ `[handleDrill]` æ—¥å¿—
- ä½†é¢æ¿ä¸åˆ·æ–°

**å¯èƒ½åŸå› **ï¼š

#### 3.1 FileTreeScanner æŠ¥é”™

æŸ¥çœ‹æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯æ—¥å¿—ã€‚

#### 3.2 showGraph æœªè°ƒç”¨

æ£€æŸ¥ `handleDrill` ä¸­æ˜¯å¦æ­£ç¡®è°ƒç”¨äº† `this.showGraph(graph)`ã€‚

---

### é—®é¢˜ 4ï¼šåŒå‡»å˜æˆäº†æ‹–æ‹½

**ç—‡çŠ¶**ï¼š
- è½»å¾®ç§»åŠ¨é¼ æ ‡å°±å¼€å§‹æ‹–æ‹½
- æ§åˆ¶å°æœ‰ `[æ‹–æ‹½] å¼€å§‹æ‹–æ‹½` æ—¥å¿—
- æ²¡æœ‰ `[åŒå‡»]` æ—¥å¿—

**åŸå› **ï¼š
- ç§»åŠ¨é˜ˆå€¼æœªç”Ÿæ•ˆ

**æ£€æŸ¥ä»£ç **ï¼š
```javascript
// åœ¨ graphView.js ä¸­æŸ¥æ‰¾ï¼š
const DRAG_THRESHOLD = 5;
```

ç¡®ä¿è¿™è¡Œä»£ç å­˜åœ¨ä¸”å€¼ä¸º 5ã€‚

---

## ğŸ“Š æ­£å¸¸å·¥ä½œçš„å®Œæ•´æ—¥å¿—ç¤ºä¾‹

### å®Œæ•´æµ‹è¯•æµç¨‹æ—¥å¿—

```
=== å¯ç”¨è¯Šæ–­ ===
ğŸ” äº‹ä»¶è¯Šæ–­: å¼€å¯
ğŸ“Š å½“å‰å›¾è¡¨çŠ¶æ€: {graphType: 'filetree', nodeCount: 5, folderNodes: 2, rootNode: {â€¦}}
ğŸ“ æ–‡ä»¶å¤¹èŠ‚ç‚¹è¯¦æƒ…:
  - src: {hasPath: true, path: 'D:\\project\\src', isRoot: true, position: {â€¦}}
  - utils: {hasPath: true, path: 'D:\\project\\src\\utils', isRoot: false, position: {â€¦}}
ğŸ’¡ æç¤ºï¼šåŒå‡»æ–‡ä»¶å¤¹èŠ‚ç‚¹æŸ¥çœ‹äº‹ä»¶è·¯å¾„

=== åŒå‡»å­æ–‡ä»¶å¤¹ 'utils' ===
ğŸ–±ï¸ åŒå‡»äº‹ä»¶è·¯å¾„: node node-folder > node-content > nodes > canvas > canvasWrap > body > html > document
ğŸ¯ ç›®æ ‡å…ƒç´ : div.node-content
ğŸ“ ç›®æ ‡ç±»å: node-content
[åŒå‡»] å­æ–‡ä»¶å¤¹ï¼Œå‘é€ drill: D:\project\src\utils

=== Extension Host æ§åˆ¶å° ===
[handleDrill] æ”¶åˆ°ä¸‹é’»è¯·æ±‚, payload: {path: 'D:\\project\\src\\utils'}
[handleDrill] æå–çš„ folderPath: D:\project\src\utils
ä¸‹é’»åˆ°: D:\project\src\utils
å¼€å§‹æµ…å±‚æ‰«æ: D:\project\src\utils
æµ…å±‚æ‰«æå®Œæˆ: 2 ä¸ªæ–‡ä»¶å¤¹, 3 ä¸ªæ–‡ä»¶
æ˜¾ç¤ºè“å›¾: ğŸ“ utils (6 ä¸ªèŠ‚ç‚¹)
å·²åˆ·æ–°åˆ°å­ç›®å½•: D:\project\src\utils

=== åŒå‡»æ ¹èŠ‚ç‚¹è¿”å› ===
[åŒå‡»] æ ¹èŠ‚ç‚¹ï¼Œå‘é€ drill-up: D:\project\src\utils

=== Extension Host æ§åˆ¶å° ===
[handleDrillUp] å¼€å§‹è¿”å›ä¸Šä¸€çº§
å½“å‰è·¯å¾„: D:\project\src\utils
çˆ¶è·¯å¾„: D:\project\src
è¿”å›ä¸Šä¸€çº§: D:\project\src
æ˜¾ç¤ºè“å›¾: ğŸ“ src (5 ä¸ªèŠ‚ç‚¹)
```

---

## âœ… æµ‹è¯•é€šè¿‡æ ‡å‡†

- [ ] Ctrl+Shift+D èƒ½å¯ç”¨è¯Šæ–­æ¨¡å¼
- [ ] è¯Šæ–­ä¿¡æ¯æ˜¾ç¤º `graphType: 'filetree'`
- [ ] æ‰€æœ‰æ–‡ä»¶å¤¹èŠ‚ç‚¹éƒ½æœ‰ `path` å±æ€§
- [ ] åŒå‡»å­æ–‡ä»¶å¤¹èƒ½ä¸‹é’»ï¼ˆæ—¥å¿— + é¢æ¿åˆ·æ–°ï¼‰
- [ ] åŒå‡»æ ¹èŠ‚ç‚¹èƒ½ä¸Šé’»ï¼ˆæ—¥å¿— + é¢æ¿åˆ·æ–°ï¼‰
- [ ] æ‹–æ‹½èŠ‚ç‚¹ä»æ­£å¸¸å·¥ä½œ
- [ ] è½»å¾®æŠ–åŠ¨ä¸å½±å“åŒå‡»ï¼ˆç§»åŠ¨ < 5pxï¼‰

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœæµ‹è¯•å¤±è´¥ï¼Œè¯·æä¾›ï¼š

1. **Webview æ§åˆ¶å°çš„å®Œæ•´è¾“å‡º**ï¼ˆåŒ…æ‹¬è¯Šæ–­ä¿¡æ¯ï¼‰
2. **Extension Host æ§åˆ¶å°çš„å®Œæ•´è¾“å‡º**
3. **å…·ä½“å“ªä¸€æ­¥å¤±è´¥äº†**
4. **æˆªå›¾**ï¼ˆå¦‚æœå¯èƒ½ï¼‰

å°†è¿™äº›ä¿¡æ¯å‘ç»™æˆ‘ï¼Œæˆ‘ä¼šå¸®ä½ å®šä½é—®é¢˜ï¼

---

*æµ‹è¯•æŒ‡å—åˆ›å»ºæ—¶é—´ï¼š2025-10-16*  
*é€‚ç”¨ç‰ˆæœ¬ï¼šå·²ä¿®å¤æ‹–æ‹½å¹²æ‰° + CSSä¼˜åŒ– + è¯Šæ–­å·¥å…·*
