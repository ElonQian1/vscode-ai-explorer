# å³é”®èœå•è°ƒè¯•æŒ‡å—

## ğŸ¯ é¢„æœŸè¡Œä¸º
åœ¨ **AI èµ„æºç®¡ç†å™¨** ä¸­å³é”®æ–‡ä»¶å¤¹ â†’ é€‰æ‹©"åœ¨æ­¤æ‰“å¼€è“å›¾" â†’ **ç›´æ¥æ‰“å¼€è¯¥æ–‡ä»¶å¤¹çš„è“å›¾**ï¼Œä¸åº”å¼¹å‡ºæ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†ã€‚

---

## âœ… å·²ä¿®å¤çš„å†…å®¹

### 1. ExplorerTreeItem.ts
```typescript
// å·²æ·»åŠ  resourceUri å±æ€§
this.resourceUri = vscode.Uri.file(this.node.path);
```

### 2. package.json
```jsonc
// å·²ä¼˜åŒ–èœå•æ¡ä»¶ï¼Œåªåœ¨æ–‡ä»¶å¤¹ä¸Šæ˜¾ç¤º
{
  "command": "filetreeBlueprint.openFromPath",
  "when": "view == aiExplorer && (viewItem == folder || viewItem == folderHasAlias)",
  "group": "navigation@17"
}
```

### 3. resolveTarget.ts
```typescript
// å·²ä¼˜åŒ–å‚æ•°æå–é€»è¾‘å¹¶æ·»åŠ è°ƒè¯•æ—¥å¿—
// ä¼˜å…ˆæ£€æŸ¥ resourceUriï¼ˆTreeItem å¯¹è±¡ï¼‰
if ((raw as any)?.resourceUri instanceof vscode.Uri) {
    uri = (raw as any).resourceUri as vscode.Uri;
    console.log('[resolveTargetToFileUri] ä» resourceUri æå–:', uri.toString());
}
```

---

## ğŸ” è°ƒè¯•æ­¥éª¤

### Step 1: é‡æ–°åŠ è½½ VS Code
1. æŒ‰ `F1` æˆ– `Ctrl+Shift+P`
2. è¾“å…¥å¹¶æ‰§è¡Œ: `Developer: Reload Window`

### Step 2: æ‰“å¼€å¼€å‘è€…å·¥å…·
1. æŒ‰ `F1` æˆ– `Ctrl+Shift+P`
2. è¾“å…¥å¹¶æ‰§è¡Œ: `Developer: Toggle Developer Tools`
3. åˆ‡æ¢åˆ° **Console** æ ‡ç­¾

### Step 3: æµ‹è¯•å³é”®èœå•
1. åœ¨ **AI èµ„æºç®¡ç†å™¨** è§†å›¾ä¸­æ‰¾åˆ°ä»»æ„æ–‡ä»¶å¤¹
2. **å³é”®ç‚¹å‡»** æ–‡ä»¶å¤¹
3. é€‰æ‹© "**åœ¨æ­¤æ‰“å¼€è“å›¾**"
4. è§‚å¯Ÿæ§åˆ¶å°è¾“å‡º

---

## ğŸ“Š é¢„æœŸçš„æ§åˆ¶å°æ—¥å¿—

### âœ… æˆåŠŸæƒ…å†µï¼ˆåº”è¯¥çœ‹åˆ°ï¼‰
```
[resolveTargetToFileUri] æ¥æ”¶å‚æ•°ç±»å‹: object
[resolveTargetToFileUri] å‚æ•°è¯¦æƒ…: ExplorerTreeItem {...}
[resolveTargetToFileUri] resourceUri: file:///D:/your-project/some-folder
[resolveTargetToFileUri] ä» resourceUri æå–: file:///D:/your-project/some-folder
å·²è§£æç›®æ ‡: /some-folder (D:\your-project\some-folder)
```

### âŒ å¤±è´¥æƒ…å†µï¼ˆä¸åº”è¯¥çœ‹åˆ°ï¼‰
```
[resolveTargetToFileUri] æ¥æ”¶å‚æ•°ç±»å‹: undefined
[resolveTargetToFileUri] æœªæ£€æµ‹åˆ°ä»»ä½• URIï¼Œå‡†å¤‡å¼¹å‡ºé€‰æ‹©æ¡†
æœªæ£€æµ‹åˆ°æ–‡ä»¶ä¸Šä¸‹æ–‡ï¼Œè¯·é€‰æ‹©è¦ç”Ÿæˆè“å›¾çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹
```

---

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜ 1: ä»ç„¶å¼¹å‡ºæ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†

**å¯èƒ½åŸå›  A**: resourceUri æ²¡æœ‰æ­£ç¡®è®¾ç½®
```bash
# æ£€æŸ¥æ–¹æ³•ï¼šåœ¨ ExplorerTreeItem.ts çš„ setupTreeItem() ä¸­æ·»åŠ æ—¥å¿—
console.log('[TreeItem] resourceUri:', this.resourceUri?.toString());
```

**å¯èƒ½åŸå›  B**: èœå•æ¡ä»¶æ²¡æœ‰å‘½ä¸­
```bash
# æ£€æŸ¥æ–¹æ³•ï¼š
1. F1 â†’ "Developer: Inspect Context Keys"
2. åœ¨ AI èµ„æºç®¡ç†å™¨ä¸­ç‚¹å‡»æ–‡ä»¶å¤¹
3. æŸ¥çœ‹ï¼š
   - view = "aiExplorer" âœ…
   - viewItem = "folder" æˆ– "folderHasAlias" âœ…
```

**å¯èƒ½åŸå›  C**: å‚æ•°ä¼ é€’å¤±è´¥
```bash
# æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ä¸­çš„"æ¥æ”¶å‚æ•°ç±»å‹"å’Œ"å‚æ•°è¯¦æƒ…"
# å¦‚æœæ˜¯ undefinedï¼Œè¯´æ˜å‘½ä»¤æ²¡æœ‰æ¥æ”¶åˆ° TreeItem
```

### é—®é¢˜ 2: æ‰“å¼€äº†é”™è¯¯çš„æ–‡ä»¶å¤¹

**æ£€æŸ¥ resolveTargetToFileUri çš„æ—¥å¿—**:
- æå–çš„ URI è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼Ÿ
- focusPath è®¡ç®—æ˜¯å¦æ­£ç¡®ï¼Ÿ

### é—®é¢˜ 3: èœå•é¡¹æ ¹æœ¬ä¸æ˜¾ç¤º

**æ£€æŸ¥ package.json ä¸­çš„ when æ¡ä»¶**:
```jsonc
"when": "view == aiExplorer && (viewItem == folder || viewItem == folderHasAlias)"
```

**æ£€æŸ¥ ExplorerTreeItem.ts ä¸­çš„ contextValue**:
```typescript
this.contextValue = this.node.type === 'file'
    ? (hasAlias ? 'fileHasAlias' : 'file')
    : (hasAlias ? 'folderHasAlias' : 'folder');
```

---

## ğŸ“ è‡ªæ£€æ¸…å•

- [ ] é‡æ–°åŠ è½½äº† VS Code çª—å£
- [ ] æ‰“å¼€äº†å¼€å‘è€…å·¥å…·æ§åˆ¶å°
- [ ] å³é”®ç‚¹å‡»æ–‡ä»¶å¤¹æ—¶èƒ½çœ‹åˆ°"åœ¨æ­¤æ‰“å¼€è“å›¾"èœå•é¡¹
- [ ] æ§åˆ¶å°æ˜¾ç¤ºæ­£ç¡®çš„ resourceUri æ—¥å¿—
- [ ] æ²¡æœ‰å¼¹å‡ºæ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†
- [ ] è“å›¾é¢æ¿æ‰“å¼€çš„æ˜¯æ­£ç¡®çš„æ–‡ä»¶å¤¹
- [ ] é¢æ¿æ ‡é¢˜æ˜¾ç¤ºæ­£ç¡®çš„æ–‡ä»¶å¤¹å

---

## ğŸ“ æŠ€æœ¯åŸç†

### VS Code å³é”®èœå•å‚æ•°ä¼ é€’æœºåˆ¶

1. **TreeItem æä¾› resourceUri**
   ```typescript
   this.resourceUri = vscode.Uri.file(this.node.path);
   ```

2. **VS Code è°ƒç”¨å‘½ä»¤æ—¶ä¼ é€’ TreeItem**
   ```typescript
   vscode.commands.executeCommand('filetreeBlueprint.openFromPath', treeItem);
   ```

3. **å‘½ä»¤å¤„ç†å™¨æå– resourceUri**
   ```typescript
   const uri = (raw as any)?.resourceUri;
   ```

4. **ä½¿ç”¨ URI æ‰“å¼€è“å›¾**
   ```typescript
   await this.generateUseCase.executeFromPath(uri);
   ```

### ä¸ºä»€ä¹ˆéœ€è¦ viewItem æ¡ä»¶ï¼Ÿ

å¦‚æœæ²¡æœ‰ `viewItem` é™åˆ¶ï¼Œèœå•ä¼šåœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šæ˜¾ç¤ºï¼ŒåŒ…æ‹¬ï¼š
- âŒ æ–‡ä»¶èŠ‚ç‚¹ï¼ˆæ— æ³•ç”Ÿæˆè“å›¾ï¼‰
- âŒ ç©ºç™½åŒºåŸŸï¼ˆæ²¡æœ‰ä¸Šä¸‹æ–‡ï¼‰
- âœ… æ–‡ä»¶å¤¹èŠ‚ç‚¹ï¼ˆæ­£ç¡®ï¼‰

æ·»åŠ æ¡ä»¶åï¼š
```jsonc
"when": "view == aiExplorer && (viewItem == folder || viewItem == folderHasAlias)"
```
èœå•åªåœ¨æ–‡ä»¶å¤¹èŠ‚ç‚¹ä¸Šæ˜¾ç¤ºï¼Œç¡®ä¿ä¼ é€’çš„æ˜¯æœ‰æ•ˆçš„æ–‡ä»¶å¤¹ URIã€‚

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å³é”®æ‰“å¼€ç”»é¢.md](./å³é”®æ‰“å¼€ç”»é¢.md) - åŸå§‹é—®é¢˜æè¿°ä¸è§£å†³æ–¹æ¡ˆ
- [æ–‡ä»¶å¤¹ä¸‹é’»é—®é¢˜2.md](./æ–‡ä»¶å¤¹ä¸‹é’»é—®é¢˜2.md) - æ–‡ä»¶å¤¹å¯¼èˆªé€»è¾‘
- [VS Code TreeView API](https://code.visualstudio.com/api/extension-guides/tree-view)

---

## ğŸ”„ å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨

è¯·æ”¶é›†ä»¥ä¸‹ä¿¡æ¯å¹¶æäº¤é—®é¢˜ï¼š

1. **æ§åˆ¶å°å®Œæ•´æ—¥å¿—** (ä» Developer Tools)
2. **ä½ å³é”®çš„æ–‡ä»¶å¤¹è·¯å¾„** (ä¾‹å¦‚: `D:\project\src\features`)
3. **æ˜¯å¦å¼¹å‡ºäº†é€‰æ‹©æ¡†** (æ˜¯/å¦)
4. **VS Code ç‰ˆæœ¬** (Help â†’ About)
5. **æ‰©å±•ç‰ˆæœ¬** (ä» package.json ä¸­çš„ version å­—æ®µ)

ç„¶ååœ¨é¡¹ç›®ä¸­åˆ›å»º Issue æˆ–åœ¨å¼€å‘è€…å·¥å…·ä¸­ç»§ç»­è°ƒè¯•ã€‚
