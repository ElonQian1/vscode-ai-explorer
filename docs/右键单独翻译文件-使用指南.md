# 右键单独翻译文件 - 使用指南

## 🎯 功能概述

现在你可以通过右键菜单直接翻译单个文件，无需翻译整个目录！

## 📝 三种使用方式

### 方式 1: AI Explorer 视图中右键

1. 打开 AI 资源管理器视图
2. 展开目录找到目标文件
3. **右键点击文件**
4. 选择 **"AI 资源管理器：翻译此文件（仅此文件）"**

```
📁 src/
  📁 features/
    📄 index.ts  ← 右键点击这里
      └─ 📋 翻译此文件（仅此文件）
```

### 方式 2: VS Code 原生资源管理器右键

1. 在 VS Code 左侧资源管理器中
2. **右键点击任意文件**
3. 选择 **"AI 资源管理器：翻译此文件（仅此文件）"**

```
VS Code 资源管理器
📁 WORKSPACE/
  📄 config.json  ← 右键点击
    └─ 📋 翻译此文件（仅此文件）
```

### 方式 3: 命令面板调用

1. 打开任意文件（成为活动编辑器）
2. 按 `Ctrl+Shift+P`（Mac: `Cmd+Shift+P`）
3. 输入 "翻译此文件"
4. 选择 **"AI 资源管理器：翻译此文件（仅此文件）"**

```
命令面板:
> AI 资源管理器：翻译此文件（仅此文件）
```

## 📊 翻译结果提示

翻译完成后会显示详细信息，包括翻译来源：

### ✅ 成功案例

```
✅ 已翻译：UserService.ts → 用户服务（来源：AI）
✅ 已翻译：package.json → 包配置文件（来源：词典）
✅ 已翻译：README.md → 自述文件（来源：缓存）
```

### ℹ️ 无需翻译

```
ℹ️ 文件无需翻译：中文文件.txt
```

### ⚠️ 警告提示

```
⚠️ 请选择一个文件执行翻译
⚠️ 当前选择的不是文件，无法执行单文件翻译
```

### ❌ 错误提示

```
❌ 翻译失败: AI 服务不可用
❌ 翻译失败: 网络超时
```

## 🔍 翻译来源说明

| 来源 | 说明 | 速度 | 准确度 |
|------|------|------|--------|
| **词典** | 预定义的标准翻译 | ⚡ 瞬间 | ⭐⭐⭐⭐⭐ |
| **缓存** | 之前翻译过的结果 | ⚡ 瞬间 | ⭐⭐⭐⭐⭐ |
| **规则** | 基于规则的翻译 | ⚡⚡ 极快 | ⭐⭐⭐⭐ |
| **AI** | AI 智能翻译 | ⚡⚡⚡ 较慢 | ⭐⭐⭐⭐⭐ |
| **回退** | 保留原名 | ⚡ 瞬间 | ⭐⭐⭐ |

## 🆚 与批量翻译的区别

| 特性 | 单文件翻译 | 批量翻译 |
|------|-----------|---------|
| **触发方式** | 右键单个文件 | 工具栏按钮 |
| **处理范围** | ✅ 仅当前文件 | 📁 递归整个目录 |
| **执行速度** | ⚡ 瞬间完成 | ⏱️ 可能需要等待 |
| **结果反馈** | 💬 即时弹窗提示 | 📊 进度条+统计 |
| **AI 调用** | 🔹 单次请求 | 🔹🔹🔹 批量处理 |
| **适用场景** | 快速翻译个别文件 | 整理新项目 |

## 🎨 使用技巧

### 技巧 1: 快速验证翻译效果

```
1. 右键翻译一个文件
2. 查看弹窗提示的来源
3. 如果来源是 "AI"，说明 AI 正在工作
4. 如果来源是 "缓存"，说明已经翻译过
```

### 技巧 2: 强制重新翻译

```
1. 右键点击文件
2. 选择 "清除节点缓存"
3. 再次右键选择 "翻译此文件"
4. 这次会调用 AI 重新翻译
```

### 技巧 3: 批量处理策略

```
第一次：使用 "翻译整个工作区" 批量处理
后续：对个别新文件使用 "翻译此文件"
```

### 技巧 4: 验证 AI 服务

```
1. 打开任意英文文件
2. 右键 "翻译此文件"
3. 查看结果来源
   - 如果是 "AI" → AI 服务正常
   - 如果是 "词典/缓存" → 未调用 AI（已有结果）
   - 如果失败 → 检查 API Key 配置
```

## 🔧 常见问题

### Q1: 右键菜单中没有"翻译此文件"选项？

**原因可能是：**
- 选中的是文件夹而非文件
- 扩展未正确加载

**解决方法：**
1. 确保选中的是文件（不是文件夹）
2. 按 F5 重启扩展开发主机
3. 检查 AI Explorer 视图是否正常显示

### Q2: 翻译后显示 "来源：回退"？

**这表示：**
- AI 服务未配置或不可用
- 词典和缓存中都没有该文件的翻译
- 系统保留了原文件名

**解决方法：**
1. 运行命令：**"检查AI状态"** 查看 AI 配置
2. 设置 API Key（OpenAI 或腾讯混元）
3. 重新尝试翻译

### Q3: 翻译速度很慢？

**原因分析：**
- 来源是 "AI" → 正常，需要网络请求（1-3秒）
- 来源是 "词典/缓存" → 应该瞬间完成

**优化建议：**
1. 首次翻译使用批量模式（会建立缓存）
2. 后续翻译自动使用缓存（瞬间完成）
3. 检查网络连接（AI 模式）

### Q4: 翻译结果不满意？

**解决方法：**
1. **方法一：清除缓存重新翻译**
   - 右键 → "清除节点缓存"
   - 再次翻译

2. **方法二：添加到词典**
   - 编辑词典文件
   - 添加自定义翻译
   - 重新加载别名

3. **方法三：手动重命名**
   - 右键 → "用别名重命名文件"
   - 手动修改别名

### Q5: 在原生资源管理器中右键翻译后，AI Explorer 没有更新？

**原因：**
- 视图未刷新

**解决方法：**
1. 点击 AI Explorer 视图的刷新按钮 🔄
2. 或运行命令：**"刷新"**

## 📚 相关功能

### 配套功能 1: 复制别名

```
右键文件 → "复制别名"
将中文别名复制到剪贴板
```

### 配套功能 2: 用别名重命名

```
右键文件 → "用别名重命名文件"
⚠️ 谨慎操作：会真实修改文件名
```

### 配套功能 3: 清除缓存

```
右键文件 → "清除节点缓存"
清除该文件的翻译缓存，下次会重新翻译
```

### 配套功能 4: 切换显示

```
工具栏 → "切换别名显示" 👁️
在原名/别名之间切换主显示
```

## 🚀 工作流建议

### 新项目初始化

```
1. 打开项目
2. 工具栏 → "翻译整个工作区"
3. 等待批量翻译完成
4. 后续新增文件 → 右键 "翻译此文件"
```

### 日常开发流程

```
1. 创建新文件（如 UserController.ts）
2. 右键 → "翻译此文件"
3. 查看别名（用户控制器）
4. 继续开发
```

### 代码审查流程

```
1. 在资源管理器中浏览文件
2. 对不熟悉的文件右键 "翻译此文件"
3. 通过中文别名快速理解文件用途
4. 无需重命名真实文件
```

## 🎯 下一步

现在你已经掌握了右键单独翻译文件的功能，可以：

1. ✅ 试试在 AI Explorer 视图中右键翻译
2. ✅ 试试在原生资源管理器中右键翻译
3. ✅ 试试命令面板调用
4. ✅ 观察翻译来源提示
5. ✅ 配合其他右键功能使用

## 📖 相关文档

- [架构设计说明](./右键单独翻译文件-架构说明.md)
- [翻译模块详解](./第3步.md)
- [右键菜单功能](./右键菜单功能使用指南.md)
- [AI 诊断工具](./AI诊断和测试指南.md)
