# 🧪 AI分析功能测试指南

## 🎯 测试目标
验证右键AI分析功能是否完整，并确认腾讯元宝调用正常。

## 🚀 详细测试步骤

### 1. 启动调试环境
1. **确保项目编译**：运行 `npm run compile`
2. **按F5启动调试模式** 
3. **等待"Extension Development Host"窗口出现**
4. **在新窗口中打开一个项目文件夹**

### 2. 诊断命令注册
1. **按 Ctrl+Shift+P 打开命令面板**
2. **搜索 "AI Explorer"**，应该看到：
   - `AI Explorer: Set Hunyuan Key`
   - `AI Explorer: Set OpenAI Key`
   - `AI Explorer: Choose Provider`
   - 等其他命令
3. **如果看不到命令，检查控制台错误**

### 3. 配置AI服务 (重要!)
1. **配置腾讯元宝API Key**：
   - 按 `Ctrl+Shift+P`
   - 输入 `AI Explorer: Set Hunyuan Key`
   - 输入腾讯元宝API Key
   - 应该看到 "腾讯混元 API Key 设置成功！"
2. **验证配置**：
   - 按 `Ctrl+Shift+P`
   - 运行 `AI Explorer: Check AI Status`
   - 应该显示 "✅ 腾讯混元: 已配置"

### 4. 测试右键分析功能
1. **右键点击任意文件**
2. **查看菜单中是否有**：
   - `🔍 AI 分析：分析此文件`
   - `🔄 AI 分析：重新分析`
   - `📋 AI 分析：查看详细摘要`
3. **点击"🔍 AI 分析：分析此文件"**
4. **应该立即看到调试通知**："🔍 AI分析命令已触发！正在诊断..."

### 5. 观察分析过程
1. **如果显示调试通知**：
   - 等待进度提示："正在分析: 文件名"
   - 查看最终分析结果弹窗
2. **如果没有任何反应**：
   - 打开开发者工具 (F12)
   - 查看Console标签页的错误信息
   - 记录错误并继续故障排除

## ✅ 预期结果

### 如果AI分析正常工作：
```
🔍 文件分析结果

📁 路径: /path/to/file.ts
🤖 AI分析: TypeScript模块 - 提供XXX功能
📝 详细: 该文件实现了...
🏷️ 标签: typescript, module, service
⭐ 重要性: 7/10
🤖 来源: AI智能分析 (腾讯元宝)
⏰ 分析时间: 2025-10-25 ...
```

### 如果AI未配置或失败：
```
📁 路径: /path/to/file.ts  
📝 类型: 文件
📏 大小: 2.3 KB
📄 文件行数: 68
📤 导出: 3 个
⏰ 修改时间: ...
🔍 分析时间: ...
```

## 🔍 功能验证清单

- [ ] **右键菜单显示**：有"🔍 AI 分析：分析此文件"选项
- [ ] **进度显示正常**：显示"正在分析"进度条
- [ ] **腾讯元宝调用**：结果显示"🤖 来源: AI智能分析 (腾讯元宝)"
- [ ] **分析结果完整**：包含用途、标签、重要性评分
- [ ] **错误处理**：AI失败时自动回退到基础分析
- [ ] **缓存机制**：第二次分析同一文件显示"💾 来源: 缓存"

## 🐛 故障排除

### 如果没有右键菜单：
- 确认在Extension Development Host窗口中操作
- 检查F12控制台是否有错误

### 如果显示基础分析而非AI分析：
- 检查腾讯元宝API Key是否正确配置
- 查看控制台输出AI客户端初始化日志
- 确认网络连接正常

### 如果分析失败：
- 检查API Key余额是否充足
- 查看错误日志中的详细错误信息
- 尝试重新配置API Key

## 📊 测试记录

**测试日期**: ___________
**腾讯元宝API状态**: [ ] 正常 [ ] 异常
**右键分析功能**: [ ] 完整 [ ] 部分工作 [ ] 不工作
**AI调用成功率**: _____% 
**备注**: ________________

---
💡 提示：首次AI分析可能需要几秒钟时间，后续会使用缓存加速。